f.lme7 +   geom_line(colour="gray",aes(y=pred1,group=stock)) +
geom_line(colour="#4DAC26",lwd=2,aes(y=pred,group=stock))+
xlab(expression(paste(log[10],"[cell number]"))) +
ylab(expression(paste(log[10], "[wing area (",mu, m^2,")]"))) +
theme(plot.title = element_text(hjust = 0.5,size = 20,face = "bold"))+
theme_bw() +
theme(legend.position = c(0.85, 0.3),
legend.background = element_rect(fill = "white"),
legend.title = element_blank())
f.lme7.plot
# ------------------------------------------------------------------------------
# Fresh mass vs cell size in males
m.lme1<-lmer(fresh_mass_log~cell_area_log + (1|stock),REML = TRUE,data=male)
male$pred <- predict(m.lme1,re.form=NA)
male$pred1 <- predict(m.lme1)
m.lme1 <- ggplot(male,aes(cell_area_log,fresh_mass_log))+
ylim(c(-0.26,0.25))+xlim(c(1.9,2.45))+
geom_point(aes(shape= stock,color = stock))+
scale_shape_manual(values=c(8,21:25))+
scale_color_manual(values = c("#A6761D","#A6761D","#A6761D","#A6761D","#A6761D","#A6761D"))
m.lme1.plot=
m.lme1 +   geom_line(colour="gray",aes(y=pred1,group=stock)) +
geom_line(colour="#A6761D",lwd=2,aes(y=pred,group=stock))+
xlab(expression(paste(log[10], "[cell area (",mu, m^2,")]"))) +
ylab(expression(paste(log[10],"[fresh mass (mg)]"))) +
ggtitle("Males")+
theme(plot.title = element_text(hjust = 0.5,size = 20,face = "bold"))+
theme_bw() +
theme(legend.position = c(0.12,0.72),
legend.background = element_rect(fill = "white"),
legend.title = element_blank())
m.lme1.plot
# Fresh mass vs cell number in males
m.lme3<-lmer(fresh_mass_log~cell_number_log+ (1|stock),REML = TRUE,data=male)
male$pred <- predict(m.lme3,re.form=NA)
male$pred1 <- predict(m.lme3)
m.lme3 <- ggplot(male,aes(cell_number_log,fresh_mass_log))+
ylim(c(-0.26,0.25))+xlim(c(3.7,4))+
geom_point(aes(shape= stock,color = stock))+
scale_shape_manual(values=c(8,21:25))+
scale_color_manual(values = c("#A6761D","#A6761D","#A6761D","#A6761D","#A6761D","#A6761D"))
m.lme3.plot=
m.lme3 +   geom_line(colour="gray",aes(y=pred1,group=stock)) +
geom_line(colour="#A6761D",lwd=2,aes(y=pred,group=stock))+
xlab(expression(paste(log[10],"[cell number]"))) +
ylab(expression(paste(log[10],"[fresh mass (mg)]"))) +
ggtitle("Males")+
theme(plot.title = element_text(hjust = 0.5,size = 20,face = "bold"))+
theme_bw() +
theme(legend.position = c(0.85, 0.3),
legend.background = element_rect(fill = "white"),
legend.title = element_blank())
m.lme3.plot
# Wing area vs cell size in males
m.lme5<-lmer(wing_area_log~cell_area_log+ (1|stock),REML = TRUE,data=male)
male$pred <- predict(m.lme5,re.form=NA)
male$pred1 <- predict(m.lme5)
m.lme5 <- ggplot(male,aes(cell_area_log,wing_area_log))+
ylim(c(5.8,6.3))+xlim(c(1.9,2.45))+
geom_point(aes(shape= stock,color = stock))+
scale_shape_manual(values=c(8,21:25))+
scale_color_manual(values = c("#A6761D","#A6761D","#A6761D","#A6761D","#A6761D","#A6761D"))
m.lme5.plot=
m.lme5 +   geom_line(colour="gray",aes(y=pred1,group=stock)) +
geom_line(colour="#A6761D",lwd=2,aes(y=pred,group=stock))+
xlab(expression(paste(log[10], "[cell area (",mu, m^2,")]"))) +
ylab(expression(paste(log[10], "[wing area (",mu, m^2,")]"))) +
theme(plot.title = element_text(hjust = 0.5,size = 20,face = "bold"))+
theme_bw() +
theme(legend.position = c(0.12,0.72),
legend.background = element_rect(fill = "white"),
legend.title = element_blank())
m.lme5.plot
# Wing area vs cell number in males
m.lme7<-lmer(wing_area_log~cell_number_log+ (1|stock),REML = TRUE,data=male)
male$pred <- predict(m.lme7,re.form=NA)
male$pred1 <- predict(m.lme7)
m.lme7 <- ggplot(male,aes(cell_number_log,wing_area_log))+
ylim(c(5.8,6.3))+xlim(c(3.7,4))+
geom_point(aes(shape= stock,color = stock))+
scale_shape_manual(values=c(8,21:25))+
scale_color_manual(values = c("#A6761D","#A6761D","#A6761D","#A6761D","#A6761D","#A6761D"))
m.lme7.plot=
m.lme7 +   geom_line(colour="gray",aes(y=pred1,group=stock)) +
geom_line(colour="#A6761D",lwd=2,aes(y=pred,group=stock))+
xlab(expression(paste(log[10],"[cell number]"))) +
ylab(expression(paste(log[10], "[wing area (",mu, m^2,")]"))) +
theme(plot.title = element_text(hjust = 0.5,size = 20,face = "bold"))+
theme_bw() +
theme(legend.position = c(0.85, 0.3),
legend.background = element_rect(fill = "white"),
legend.title = element_blank())
m.lme7.plot
# ------------------------------------------------------------------------------
# Fresh mass vs cell size in sex pooled
p.lme1<-lmer(fresh_mass_log~cell_area_log + (1|stock),REML = TRUE,data=dat)
dat$pred <- predict(p.lme1,re.form=NA)
dat$pred1 <- predict(p.lme1)
p.lme1 <- ggplot(dat,aes(cell_area_log,fresh_mass_log))+
ylim(c(-0.26,0.25))+xlim(c(1.9,2.45))+
geom_point(aes(shape= stock,color = stock))+
scale_shape_manual(values=c(8,21:25))+
scale_color_manual(values = c("#555555","#555555","#555555","#555555","#555555","#555555"))
p.lme1.plot=
p.lme1 +   geom_line(colour="gray",aes(y=pred1,group=stock)) +
geom_line(colour="#555555",lwd=2,aes(y=pred,group=stock))+
xlab(expression(paste(log[10], "[cell area (",mu, m^2,")]"))) +
ylab(expression(paste(log[10],"[fresh mass (mg)]"))) +
ggtitle("Sex pooled")+
theme(plot.title = element_text(hjust = 0.5,size = 40,face = "bold"))+
theme_bw() +
theme(legend.position = c(0.12,0.72),
legend.background = element_rect(fill = "white"),
legend.title = element_blank())
p.lme1.plot
# Fresh mass vs cell number in sex pooled
p.lme3<-lmer(fresh_mass_log~cell_number_log+ (1|stock),REML = TRUE,data=dat)
dat$pred <- predict(p.lme3,re.form=NA)
dat$pred1 <- predict(p.lme3)
p.lme3 <- ggplot(dat,aes(cell_number_log,fresh_mass_log))+
ylim(c(-0.26,0.25))+xlim(c(3.7,4))+
geom_point(aes(shape= stock,color = stock))+
scale_shape_manual(values=c(8,21:25))+
scale_color_manual(values = c("#555555","#555555","#555555","#555555","#555555","#555555"))
p.lme3.plot=
p.lme3 +   geom_line(colour="gray",aes(y=pred1,group=stock)) +
geom_line(colour="#555555",lwd=2,aes(y=pred,group=stock))+
xlab(expression(paste(log[10],"[cell number]"))) +
ylab(expression(paste(log[10],"[fresh mass (mg)]"))) +
ggtitle("Females")+
ggtitle("Sex pooled")+
theme(plot.title = element_text(hjust = 0.5,size = 20,face = "bold"))+
theme_bw() +
theme(legend.position = c(0.85, 0.3),
legend.background = element_rect(fill = "white"),
legend.title = element_blank())
p.lme3.plot
# Wing area vs cell size in sex pooled
p.lme5<-lmer(wing_area_log~cell_area_log+ (1|stock),REML = TRUE,data=dat)
dat$pred <- predict(p.lme5,re.form=NA)
dat$pred1 <- predict(p.lme5)
p.lme5 <- ggplot(dat,aes(cell_area_log,wing_area_log))+
ylim(c(5.8,6.3))+xlim(c(1.9,2.45))+
geom_point(aes(shape= stock,color = stock))+
scale_shape_manual(values=c(8,21:25))+
scale_color_manual(values = c("#555555","#555555","#555555","#555555","#555555","#555555"))
p.lme5.plot=
p.lme5 +   geom_line(colour="gray",aes(y=pred1,group=stock)) +
geom_line(colour="#555555",lwd=2,aes(y=pred,group=stock))+
xlab(expression(paste(log[10], "[cell area (",mu, m^2,")]"))) +
ylab(expression(paste(log[10], "[wing area (",mu, m^2,")]"))) +
theme(plot.title = element_text(hjust = 0.5,size = 20,face = "bold"))+
theme_bw() +
theme(legend.position = c(0.12,0.72),
legend.background = element_rect(fill = "white"),
legend.title = element_blank())
p.lme5.plot
# Wing area vs cell number in sex pooled
p.lme7<-lmer(wing_area_log~cell_number_log + (1|stock),REML = TRUE,data=dat)
dat$pred <- predict(p.lme7,re.form=NA)
dat$pred1 <- predict(p.lme7)
p.lme7 <- ggplot(dat,aes(cell_number_log,wing_area_log))+
ylim(c(5.8,6.3))+xlim(c(3.7,4))+
geom_point(aes(shape= stock,color = stock))+
scale_shape_manual(values=c(8,21:25))+
scale_color_manual(values = c("#555555","#555555","#555555","#555555","#555555","#555555"))
p.lme7.plot=
p.lme7 +   geom_line(colour="gray",aes(y=pred1,group=stock)) +
geom_line(colour="#555555",lwd=2,aes(y=pred,group=stock))+
xlab(expression(paste(log[10],"[cell number]"))) +
ylab(expression(paste(log[10], "[wing area (",mu, m^2,")]"))) +
theme(plot.title = element_text(hjust = 0.5,size = 20,face = "bold"))+
theme_bw() +
theme(legend.position = c(0.85, 0.3),
legend.background = element_rect(fill = "white"),
legend.title = element_blank())
p.lme7.plot
# ------------------------------------------------------------------------------
setwd("../Outputs/")#Set directory
#Figure 3
Figure_3<-plot_grid(f.lme1.plot,m.lme1.plot,p.lme1.plot,
f.lme5.plot,m.lme5.plot,p.lme5.plot,
labels=c("A","B","C",
"D","E","F")
,nrow = 2,ncol = 3,label_size=15)
#Figure 4
Figure_4<-plot_grid(f.lme3.plot,m.lme3.plot,p.lme3.plot,
f.lme7.plot,m.lme7.plot,p.lme7.plot,
labels=c("A","B","C",
"D","E","F")
,nrow = 2,ncol = 3,label_size=15)
##Store Plots
ggsave('3.2.1. Figure 3.pdf',Figure_3,width=12,height=8)
ggsave('3.2.1. Figure 3.png',Figure_3,width=12,height=8)
ggsave('3.2.2. Figure 4.pdf',Figure_4,width=12,height=8)
ggsave('3.2.2. Figure 4.png',Figure_4,width=12,height=8)
}
# ------------------------------------------------------------------------------
# Figure 3 and Figure 4
# ------------------------------------------------------------------------------
{
# Fresh mass vs cell size in females
f.lme1<-lmer(fresh_mass_log~cell_area_log+ (1|stock),REML = TRUE, data=female)
#coef(summary(f.lme1))[ , "Estimate"]
female$pred <- predict(f.lme1,re.form=NA)
female$pred1 <- predict(f.lme1)
f.lme1 <- ggplot(female,aes(cell_area_log,fresh_mass_log))+
ylim(c(-0.26,0.25))+xlim(c(1.9,2.45))+
geom_point(aes(shape= stock,color = stock))+
scale_shape_manual(values=c(8,21:25))+
scale_color_manual(values = c("#4DAC26","#4DAC26","#4DAC26","#4DAC26","#4DAC26","#4DAC26"))
f.lme1.plot=
f.lme1 +   geom_line(colour="gray",aes(y=pred1,group=stock)) +
geom_line(colour="#4DAC26",lwd=2,aes(y=pred,group=stock))+
xlab(expression(paste(log[10], "[cell area (",mu, m^2,")]"))) +
ylab(expression(paste(log[10],"[fresh mass (mg)]"))) +
ggtitle("Females")+
theme(plot.title = element_text(hjust = 0.5,size = 40,face = "bold"))+
# annotate('text', x = 2.15, y = 0.225,
#          label = "Log[10]~FM== -1.035~+~0.481~Log[10]~CA",parse = TRUE,size=4)+
theme_bw()+
theme(legend.position = c(0.15,0.72),
legend.background = element_rect(fill = "white"),
legend.title = element_blank())
f.lme1.plot
# Fresh mass vs cell number in females
f.lme3<-lmer(fresh_mass_log~cell_number_log+ (1|stock),REML = TRUE,data=female)
female$pred <- predict(f.lme3,re.form=NA)
female$pred1 <- predict(f.lme3)
f.lme3 <- ggplot(female,aes(cell_number_log,fresh_mass_log))+
ylim(c(-0.26,0.25))+xlim(c(3.7,4))+
geom_point(aes(shape= stock,color = stock))+
scale_shape_manual(values=c(8,21:25))+
scale_color_manual(values = c("#4DAC26","#4DAC26","#4DAC26","#4DAC26","#4DAC26","#4DAC26"))
f.lme3.plot=
f.lme3 +   geom_line(colour="gray",aes(y=pred1,group=stock)) +
geom_line(colour="#4DAC26",lwd=2,aes(y=pred,group=stock))+
xlab(expression(paste(log[10],"[cell number]"))) +
ylab(expression(paste(log[10],"[fresh mass (mg)]"))) +
ggtitle("Females")+
theme(plot.title = element_text(hjust = 0.5,size = 20,face = "bold"))+
theme_bw() +
theme(legend.position = c(0.85, 0.3),
legend.background = element_rect(fill = "white"),
legend.title = element_blank())
f.lme3.plot
# Wing area vs cell size in females
f.lme5<-lmer(wing_area_log~cell_area_log+ (1|stock),REML = TRUE,data=female)
female$pred <- predict(f.lme5,re.form=NA)
female$pred1 <- predict(f.lme5)
f.lme5 <- ggplot(female,aes(cell_area_log,wing_area_log))+
ylim(c(5.8,6.3))+xlim(c(1.9,2.45))+
geom_point(aes(shape= stock,color = stock))+
scale_shape_manual(values=c(8,21:25))+
scale_color_manual(values = c("#4DAC26","#4DAC26","#4DAC26","#4DAC26","#4DAC26","#4DAC26"))
f.lme5.plot=
f.lme5 +   geom_line(colour="gray",aes(y=pred1,group=stock)) +
geom_line(colour="#4DAC26",lwd=2,aes(y=pred,group=stock))+
xlab(expression(paste(log[10], "[cell area (",mu, m^2,")]"))) +
ylab(expression(paste(log[10], "[wing area (",mu, m^2,")]"))) +
theme(plot.title = element_text(hjust = 0.5,size = 40,face = "bold"))+
theme_bw() +
theme(legend.position = c(0.15,0.72),
legend.background = element_rect(fill = "white"),
legend.title = element_blank())
f.lme5.plot
# Wing area vs cell number in females
f.lme7<-lmer(wing_area_log~cell_number_log+ (1|stock),REML = TRUE,data=female)
female$pred <- predict(f.lme7,re.form=NA)
female$pred1 <- predict(f.lme7)
f.lme7 <- ggplot(female,aes(cell_number_log,wing_area_log))+
ylim(c(5.8,6.3))+xlim(c(3.7,4))+
geom_point(aes(shape= stock,color = stock))+
scale_shape_manual(values=c(8,21:25))+
scale_color_manual(values = c("#4DAC26","#4DAC26","#4DAC26","#4DAC26","#4DAC26","#4DAC26"))
f.lme7.plot=
f.lme7 +   geom_line(colour="gray",aes(y=pred1,group=stock)) +
geom_line(colour="#4DAC26",lwd=2,aes(y=pred,group=stock))+
xlab(expression(paste(log[10],"[cell number]"))) +
ylab(expression(paste(log[10], "[wing area (",mu, m^2,")]"))) +
theme(plot.title = element_text(hjust = 0.5,size = 20,face = "bold"))+
theme_bw() +
theme(legend.position = c(0.85, 0.3),
legend.background = element_rect(fill = "white"),
legend.title = element_blank())
f.lme7.plot
# ------------------------------------------------------------------------------
# Fresh mass vs cell size in males
m.lme1<-lmer(fresh_mass_log~cell_area_log + (1|stock),REML = TRUE,data=male)
male$pred <- predict(m.lme1,re.form=NA)
male$pred1 <- predict(m.lme1)
m.lme1 <- ggplot(male,aes(cell_area_log,fresh_mass_log))+
ylim(c(-0.26,0.25))+xlim(c(1.9,2.45))+
geom_point(aes(shape= stock,color = stock))+
scale_shape_manual(values=c(8,21:25))+
scale_color_manual(values = c("#A6761D","#A6761D","#A6761D","#A6761D","#A6761D","#A6761D"))
m.lme1.plot=
m.lme1 +   geom_line(colour="gray",aes(y=pred1,group=stock)) +
geom_line(colour="#A6761D",lwd=2,aes(y=pred,group=stock))+
xlab(expression(paste(log[10], "[cell area (",mu, m^2,")]"))) +
ylab(expression(paste(log[10],"[fresh mass (mg)]"))) +
ggtitle("Males")+
theme(plot.title = element_text(hjust = 0.5,size = 20,face = "bold"))+
theme_bw() +
theme(legend.position = c(0.15,0.72),
legend.background = element_rect(fill = "white"),
legend.title = element_blank())
m.lme1.plot
# Fresh mass vs cell number in males
m.lme3<-lmer(fresh_mass_log~cell_number_log+ (1|stock),REML = TRUE,data=male)
male$pred <- predict(m.lme3,re.form=NA)
male$pred1 <- predict(m.lme3)
m.lme3 <- ggplot(male,aes(cell_number_log,fresh_mass_log))+
ylim(c(-0.26,0.25))+xlim(c(3.7,4))+
geom_point(aes(shape= stock,color = stock))+
scale_shape_manual(values=c(8,21:25))+
scale_color_manual(values = c("#A6761D","#A6761D","#A6761D","#A6761D","#A6761D","#A6761D"))
m.lme3.plot=
m.lme3 +   geom_line(colour="gray",aes(y=pred1,group=stock)) +
geom_line(colour="#A6761D",lwd=2,aes(y=pred,group=stock))+
xlab(expression(paste(log[10],"[cell number]"))) +
ylab(expression(paste(log[10],"[fresh mass (mg)]"))) +
ggtitle("Males")+
theme(plot.title = element_text(hjust = 0.5,size = 20,face = "bold"))+
theme_bw() +
theme(legend.position = c(0.85, 0.3),
legend.background = element_rect(fill = "white"),
legend.title = element_blank())
m.lme3.plot
# Wing area vs cell size in males
m.lme5<-lmer(wing_area_log~cell_area_log+ (1|stock),REML = TRUE,data=male)
male$pred <- predict(m.lme5,re.form=NA)
male$pred1 <- predict(m.lme5)
m.lme5 <- ggplot(male,aes(cell_area_log,wing_area_log))+
ylim(c(5.8,6.3))+xlim(c(1.9,2.45))+
geom_point(aes(shape= stock,color = stock))+
scale_shape_manual(values=c(8,21:25))+
scale_color_manual(values = c("#A6761D","#A6761D","#A6761D","#A6761D","#A6761D","#A6761D"))
m.lme5.plot=
m.lme5 +   geom_line(colour="gray",aes(y=pred1,group=stock)) +
geom_line(colour="#A6761D",lwd=2,aes(y=pred,group=stock))+
xlab(expression(paste(log[10], "[cell area (",mu, m^2,")]"))) +
ylab(expression(paste(log[10], "[wing area (",mu, m^2,")]"))) +
theme(plot.title = element_text(hjust = 0.5,size = 20,face = "bold"))+
theme_bw() +
theme(legend.position = c(0.15,0.72),
legend.background = element_rect(fill = "white"),
legend.title = element_blank())
m.lme5.plot
# Wing area vs cell number in males
m.lme7<-lmer(wing_area_log~cell_number_log+ (1|stock),REML = TRUE,data=male)
male$pred <- predict(m.lme7,re.form=NA)
male$pred1 <- predict(m.lme7)
m.lme7 <- ggplot(male,aes(cell_number_log,wing_area_log))+
ylim(c(5.8,6.3))+xlim(c(3.7,4))+
geom_point(aes(shape= stock,color = stock))+
scale_shape_manual(values=c(8,21:25))+
scale_color_manual(values = c("#A6761D","#A6761D","#A6761D","#A6761D","#A6761D","#A6761D"))
m.lme7.plot=
m.lme7 +   geom_line(colour="gray",aes(y=pred1,group=stock)) +
geom_line(colour="#A6761D",lwd=2,aes(y=pred,group=stock))+
xlab(expression(paste(log[10],"[cell number]"))) +
ylab(expression(paste(log[10], "[wing area (",mu, m^2,")]"))) +
theme(plot.title = element_text(hjust = 0.5,size = 20,face = "bold"))+
theme_bw() +
theme(legend.position = c(0.85, 0.3),
legend.background = element_rect(fill = "white"),
legend.title = element_blank())
m.lme7.plot
# ------------------------------------------------------------------------------
# Fresh mass vs cell size in sex pooled
p.lme1<-lmer(fresh_mass_log~cell_area_log + (1|stock),REML = TRUE,data=dat)
dat$pred <- predict(p.lme1,re.form=NA)
dat$pred1 <- predict(p.lme1)
p.lme1 <- ggplot(dat,aes(cell_area_log,fresh_mass_log))+
ylim(c(-0.26,0.25))+xlim(c(1.9,2.45))+
geom_point(aes(shape= stock,color = stock))+
scale_shape_manual(values=c(8,21:25))+
scale_color_manual(values = c("#555555","#555555","#555555","#555555","#555555","#555555"))
p.lme1.plot=
p.lme1 +   geom_line(colour="gray",aes(y=pred1,group=stock)) +
geom_line(colour="#555555",lwd=2,aes(y=pred,group=stock))+
xlab(expression(paste(log[10], "[cell area (",mu, m^2,")]"))) +
ylab(expression(paste(log[10],"[fresh mass (mg)]"))) +
ggtitle("Sex pooled")+
theme(plot.title = element_text(hjust = 0.5,size = 40,face = "bold"))+
theme_bw() +
theme(legend.position = c(0.15,0.72),
legend.background = element_rect(fill = "white"),
legend.title = element_blank())
p.lme1.plot
# Fresh mass vs cell number in sex pooled
p.lme3<-lmer(fresh_mass_log~cell_number_log+ (1|stock),REML = TRUE,data=dat)
dat$pred <- predict(p.lme3,re.form=NA)
dat$pred1 <- predict(p.lme3)
p.lme3 <- ggplot(dat,aes(cell_number_log,fresh_mass_log))+
ylim(c(-0.26,0.25))+xlim(c(3.7,4))+
geom_point(aes(shape= stock,color = stock))+
scale_shape_manual(values=c(8,21:25))+
scale_color_manual(values = c("#555555","#555555","#555555","#555555","#555555","#555555"))
p.lme3.plot=
p.lme3 +   geom_line(colour="gray",aes(y=pred1,group=stock)) +
geom_line(colour="#555555",lwd=2,aes(y=pred,group=stock))+
xlab(expression(paste(log[10],"[cell number]"))) +
ylab(expression(paste(log[10],"[fresh mass (mg)]"))) +
ggtitle("Females")+
ggtitle("Sex pooled")+
theme(plot.title = element_text(hjust = 0.5,size = 20,face = "bold"))+
theme_bw() +
theme(legend.position = c(0.85, 0.3),
legend.background = element_blank())
p.lme3.plot
# Wing area vs cell size in sex pooled
p.lme5<-lmer(wing_area_log~cell_area_log+ (1|stock),REML = TRUE,data=dat)
dat$pred <- predict(p.lme5,re.form=NA)
dat$pred1 <- predict(p.lme5)
p.lme5 <- ggplot(dat,aes(cell_area_log,wing_area_log))+
ylim(c(5.8,6.3))+xlim(c(1.9,2.45))+
geom_point(aes(shape= stock,color = stock))+
scale_shape_manual(values=c(8,21:25))+
scale_color_manual(values = c("#555555","#555555","#555555","#555555","#555555","#555555"))
p.lme5.plot=
p.lme5 +   geom_line(colour="gray",aes(y=pred1,group=stock)) +
geom_line(colour="#555555",lwd=2,aes(y=pred,group=stock))+
xlab(expression(paste(log[10], "[cell area (",mu, m^2,")]"))) +
ylab(expression(paste(log[10], "[wing area (",mu, m^2,")]"))) +
theme(plot.title = element_text(hjust = 0.5,size = 20,face = "bold"))+
theme_bw() +
theme(legend.position = c(0.15,0.72),
legend.background = element_rect(fill = "white"),
legend.title = element_blank())
p.lme5.plot
# Wing area vs cell number in sex pooled
p.lme7<-lmer(wing_area_log~cell_number_log + (1|stock),REML = TRUE,data=dat)
dat$pred <- predict(p.lme7,re.form=NA)
dat$pred1 <- predict(p.lme7)
p.lme7 <- ggplot(dat,aes(cell_number_log,wing_area_log))+
ylim(c(5.8,6.3))+xlim(c(3.7,4))+
geom_point(aes(shape= stock,color = stock))+
scale_shape_manual(values=c(8,21:25))+
scale_color_manual(values = c("#555555","#555555","#555555","#555555","#555555","#555555"))
p.lme7.plot=
p.lme7 +   geom_line(colour="gray",aes(y=pred1,group=stock)) +
geom_line(colour="#555555",lwd=2,aes(y=pred,group=stock))+
xlab(expression(paste(log[10],"[cell number]"))) +
ylab(expression(paste(log[10], "[wing area (",mu, m^2,")]"))) +
theme(plot.title = element_text(hjust = 0.5,size = 20,face = "bold"))+
theme_bw() +
theme(legend.position = c(0.85, 0.3),
legend.background = element_blank())
p.lme7.plot
# ------------------------------------------------------------------------------
setwd("../Outputs/")#Set directory
#Figure 3
Figure_3<-plot_grid(f.lme1.plot,m.lme1.plot,p.lme1.plot,
f.lme5.plot,m.lme5.plot,p.lme5.plot,
labels=c("A","B","C",
"D","E","F")
,nrow = 2,ncol = 3,label_size=15)
#Figure 4
Figure_4<-plot_grid(f.lme3.plot,m.lme3.plot,p.lme3.plot,
f.lme7.plot,m.lme7.plot,p.lme7.plot,
labels=c("A","B","C",
"D","E","F")
,nrow = 2,ncol = 3,label_size=15)
##Store Plots
ggsave('3.2.1. Figure 3.pdf',Figure_3,width=12,height=8)
ggsave('3.2.1. Figure 3.png',Figure_3,width=12,height=8)
ggsave('3.2.2. Figure 4.pdf',Figure_4,width=12,height=8)
ggsave('3.2.2. Figure 4.png',Figure_4,width=12,height=8)
}
library(scales)
library(scales)
f.lme1 <- ggplot(female,aes(cell_area_log,fresh_mass_log))+
ylim(c(-0.26,0.25))+xlim(c(1.9,2.45))+
geom_point(aes(shape= stock,color = stock))+
scale_shape_manual(values=c(8,21:25))+
scale_color_manual(values = c("#4DAC26","#4DAC26","#4DAC26","#4DAC26","#4DAC26","#4DAC26"))
f.lme1.plot=
f.lme1 +   geom_line(colour="gray",aes(y=pred1,group=stock)) +
geom_line(colour="#4DAC26",lwd=2,aes(y=pred,group=stock))+
xlab(expression(paste(log[10], "[cell area (",mu, m^2,")]"))) +
ylab(expression(paste(log[10],"[fresh mass (mg)]"))) +
scale_x_log10(breaks = trans_breaks("log10", function(x) 10^x),
labels = trans_format("log10", math_format(10^.x))) +
scale_y_log10(breaks = trans_breaks("log10", function(x) 10^x),
labels = trans_format("log10", math_format(10^.x))) +
ggtitle("Females")+
theme(plot.title = element_text(hjust = 0.5,size = 40,face = "bold"))+
# annotate('text', x = 2.15, y = 0.225,
#          label = "Log[10]~FM== -1.035~+~0.481~Log[10]~CA",parse = TRUE,size=4)+
theme_bw()+
theme(legend.position = c(0.15,0.72),
legend.background = element_rect(fill = "white"),
legend.title = element_blank())
f.lme1.plot
f.lme1.plot=
f.lme1 +   geom_line(colour="gray",aes(y=pred1,group=stock)) +
geom_line(colour="#4DAC26",lwd=2,aes(y=pred,group=stock))+
xlab(expression(paste(log[10], "[cell area (",mu, m^2,")]"))) +
ylab(expression(paste(log[10],"[fresh mass (mg)]"))) +
scale_x_log10()+
scale_y_log10()+
ggtitle("Females")+
theme(plot.title = element_text(hjust = 0.5,size = 40,face = "bold"))+
# annotate('text', x = 2.15, y = 0.225,
#          label = "Log[10]~FM== -1.035~+~0.481~Log[10]~CA",parse = TRUE,size=4)+
theme_bw()+
theme(legend.position = c(0.15,0.72),
legend.background = element_rect(fill = "white"),
legend.title = element_blank())
f.lme1.plot
