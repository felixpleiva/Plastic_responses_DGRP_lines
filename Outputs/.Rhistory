#pdf("4.2.1. Figure 5.pdf",width = 8,height = 4,useDingbats = FALSE)
png("4.2.1. Figure 5.png",width = 10,height = 4,units = "in",res = 600)
par(mfrow=c(1,2),tcl=-0.4, family="serif",omi=c(0,0,0,0.1))
# TEMPERATURE
par(mai=c(0.86,0.85,0.1,0.2))
visreg(m,"cell_area_log",by="temperature",overlay=TRUE,
print.cond=TRUE,legend = FALSE,
points=list(col=c("#2c7fb870", "#de2d2670"),pch=16,cex=1.5),
line=list(col=c("#2c7fb8", "#de2d26"), lwd=5),
xlab=expression(paste(log[10], "[cell area (",mu, m^2,")]")),
ylab=expression(paste(log[10],"[fresh mass (mg)]")),
ylim=c(-0.4,0.1),xlim=c(1.9,2.4),
cex.axis=1.2,cex.lab=1.4)
legend("bottomright", legend=c("17°C", "25°C"),
lty = 1,lwd=4, bty="n",
col=c("#2c7fb8", "#de2d26"),cex=1.4)
# OXYGEN
par(mai=c(0.85,0.85,0.1,0.1))
visreg(m,"cell_area_log",by="oxygen",overlay=TRUE,
print.cond=TRUE,legend = FALSE,
points=list(col=c("#E6610170", "#00AFBB70"),pch=16,cex=1.5),
line=list(col=c("#E66101", "#00AFBB"), lwd=5),
xlab=expression(paste(log[10], "[cell area (",mu, m^2,")]")),
ylab=expression(paste(log[10],"[fresh mass (mg)]")),
ylim=c(-0.4,0.1),xlim=c(1.9,2.4),
cex.axis=1.2,cex.lab=1.4)
legend("bottomright", legend=c("10 kPa", "21 kPa"),
lty = 1,lwd=4, bty="n",
col=c("#E66101", "#00AFBB"),cex=1.4)
dev.off()
}
{
#pdf("4.2.1. Figure 5.pdf",width = 8,height = 4,useDingbats = FALSE)
png("4.2.1. Figure 5.png",width = 8,height = 4,units = "in",res = 600)
par(mfrow=c(1,2),tcl=-0.4, family="serif",omi=c(0,0,0,0.1))
# TEMPERATURE
par(mai=c(0.86,0.85,0.1,0.2))
visreg(m,"cell_area_log",by="temperature",overlay=TRUE,
print.cond=TRUE,legend = FALSE,
points=list(col=c("#2c7fb870", "#de2d2670"),pch=16,cex=1.5),
line=list(col=c("#2c7fb8", "#de2d26"), lwd=5),
xlab=expression(paste(log[10], "[cell area (",mu, m^2,")]")),
ylab=expression(paste(log[10],"[fresh mass (mg)]")),
ylim=c(-0.4,0.1),xlim=c(1.9,2.4),
cex.axis=1.2,cex.lab=1.4)
legend("bottomright", legend=c("17°C", "25°C"),
lty = 1,lwd=4, bty="n",
col=c("#2c7fb8", "#de2d26"),cex=1.4)
# OXYGEN
par(mai=c(0.85,0.85,0.1,0.1))
visreg(m,"cell_area_log",by="oxygen",overlay=TRUE,
print.cond=TRUE,legend = FALSE,
points=list(col=c("#E6610170", "#00AFBB70"),pch=16,cex=1.5),
line=list(col=c("#E66101", "#00AFBB"), lwd=5),
xlab=expression(paste(log[10], "[cell area (",mu, m^2,")]")),
ylab=expression(paste(log[10],"[fresh mass (mg)]")),
ylim=c(-0.4,0.1),xlim=c(1.9,2.4),
cex.axis=1.2,cex.lab=1.4)
legend("bottomright", legend=c("10 kPa", "21 kPa"),
lty = 1,lwd=4, bty="n",
col=c("#E66101", "#00AFBB"),cex=1.4)
dev.off()
}
################################################################################
# Figure 5
################################################################################
setwd("../Outputs/")#Set directory
{
#pdf("4.2.1. Figure 5.pdf",width = 8,height = 4,useDingbats = FALSE)
png("4.2.1. Figure 5.png",width = 9,height = 4.5,units = "in",res = 600)
par(mfrow=c(1,2),tcl=-0.4, family="serif",omi=c(0,0,0,0.1))
# TEMPERATURE
par(mai=c(0.86,0.85,0.1,0.2))
visreg(m,"cell_area_log",by="temperature",overlay=TRUE,
print.cond=TRUE,legend = FALSE,
points=list(col=c("#2c7fb870", "#de2d2670"),pch=16,cex=1.5),
line=list(col=c("#2c7fb8", "#de2d26"), lwd=5),
xlab=expression(paste(log[10], "[cell area (",mu, m^2,")]")),
ylab=expression(paste(log[10],"[fresh mass (mg)]")),
ylim=c(-0.4,0.1),xlim=c(1.9,2.4),
cex.axis=1.2,cex.lab=1.4)
legend("bottomright", legend=c("17°C", "25°C"),
lty = 1,lwd=4, bty="n",
col=c("#2c7fb8", "#de2d26"),cex=1.4)
# OXYGEN
par(mai=c(0.85,0.85,0.1,0.1))
visreg(m,"cell_area_log",by="oxygen",overlay=TRUE,
print.cond=TRUE,legend = FALSE,
points=list(col=c("#E6610170", "#00AFBB70"),pch=16,cex=1.5),
line=list(col=c("#E66101", "#00AFBB"), lwd=5),
xlab=expression(paste(log[10], "[cell area (",mu, m^2,")]")),
ylab=expression(paste(log[10],"[fresh mass (mg)]")),
ylim=c(-0.4,0.1),xlim=c(1.9,2.4),
cex.axis=1.2,cex.lab=1.4)
legend("bottomright", legend=c("10 kPa", "21 kPa"),
lty = 1,lwd=4, bty="n",
col=c("#E66101", "#00AFBB"),cex=1.4)
dev.off()
}
################################################################################
# Figure 5
################################################################################
setwd("../Outputs/")#Set directory
{
#pdf("4.2.1. Figure 5.pdf",width = 8,height = 4,useDingbats = FALSE)
png("4.2.1. Figure 5.png",width = 9,height = 4.5,units = "in",res = 600)
par(mfrow=c(1,2),tcl=-0.4, family="serif",omi=c(0,0,0,0.1))
# TEMPERATURE
par(mai=c(0.86,0.85,0.1,0.2))
visreg(m,"cell_area_log",by="temperature",overlay=TRUE,
print.cond=TRUE,legend = FALSE,
points=list(col=c("#2c7fb870", "#de2d2670"),pch=16,cex=1.5),
line=list(col=c("#2c7fb8", "#de2d26"), lwd=5),
xlab=expression(paste(log[10], "[cell area (",mu, m^2,")]")),
ylab=expression(paste(log[10],"[fresh mass (mg)]")),
ylim=c(-0.4,0.1),xlim=c(1.9,2.4),
cex.axis=1.2,cex.lab=1.4)
legend("bottomright", legend=c("17°C", "25°C"),
lty = 1,lwd=4, bty="n",
col=c("#2c7fb8", "#de2d26"),cex=1.4)
# OXYGEN
par(mai=c(0.85,0.84,0.1,0))
visreg(m,"cell_area_log",by="oxygen",overlay=TRUE,
print.cond=TRUE,legend = FALSE,
points=list(col=c("#E6610170", "#00AFBB70"),pch=16,cex=1.5),
line=list(col=c("#E66101", "#00AFBB"), lwd=5),
xlab=expression(paste(log[10], "[cell area (",mu, m^2,")]")),
ylab=expression(paste(log[10],"[fresh mass (mg)]")),
ylim=c(-0.4,0.1),xlim=c(1.9,2.4),
cex.axis=1.2,cex.lab=1.4)
legend("bottomright", legend=c("10 kPa", "21 kPa"),
lty = 1,lwd=4, bty="n",
col=c("#E66101", "#00AFBB"),cex=1.4)
dev.off()
}
################################################################################
# Figure 5
################################################################################
setwd("../Outputs/")#Set directory
{
#pdf("4.2.1. Figure 5.pdf",width = 8,height = 4,useDingbats = FALSE)
png("4.2.1. Figure 5.png",width = 9,height = 4.5,units = "in",res = 600)
par(mfrow=c(1,2),tcl=-0.4, family="serif",omi=c(0,0,0,0.1))
# TEMPERATURE
par(mai=c(0.86,0.85,0.2,0.2))
visreg(m,"cell_area_log",by="temperature",overlay=TRUE,
print.cond=TRUE,legend = FALSE,
points=list(col=c("#2c7fb870", "#de2d2670"),pch=16,cex=1.5),
line=list(col=c("#2c7fb8", "#de2d26"), lwd=5),
xlab=expression(paste(log[10], "[cell area (",mu, m^2,")]")),
ylab=expression(paste(log[10],"[fresh mass (mg)]")),
ylim=c(-0.4,0.1),xlim=c(1.9,2.4),
cex.axis=1.2,cex.lab=1.4)
legend("bottomright", legend=c("17°C", "25°C"),
lty = 1,lwd=4, bty="n",
col=c("#2c7fb8", "#de2d26"),cex=1.4)
# OXYGEN
par(mai=c(0.85,0.82,0.2,0.1))
visreg(m,"cell_area_log",by="oxygen",overlay=TRUE,
print.cond=TRUE,legend = FALSE,
points=list(col=c("#E6610170", "#00AFBB70"),pch=16,cex=1.5),
line=list(col=c("#E66101", "#00AFBB"), lwd=5),
xlab=expression(paste(log[10], "[cell area (",mu, m^2,")]")),
ylab=expression(paste(log[10],"[fresh mass (mg)]")),
ylim=c(-0.4,0.1),xlim=c(1.9,2.4),
cex.axis=1.2,cex.lab=1.4)
legend("bottomright", legend=c("10 kPa", "21 kPa"),
lty = 1,lwd=4, bty="n",
col=c("#E66101", "#00AFBB"),cex=1.4)
dev.off()
}
for (i in 1:12){
LineShift$CV[i]<-aggregate(cell_vol_log~stock, data = subset(dat,dat$oxygen==LineShift[i,1]&dat$temperature==LineShift[i,2]&dat$sex==LineShift[i,4]&dat$stock==LineShift[i,3]),median)[1,2]
LineShift$FM[i]<-aggregate(fresh_mass_log~stock, data = subset(dat,dat$oxygen==LineShift[i,1]&dat$temperature==LineShift[i,2]&dat$sex==LineShift[i,4]&dat$stock==LineShift[i,3]),median)[1,2]
}
LineShift$CV<-NA
LineShift$FM<-NA
for (i in 1:12){
LineShift$CV[i]<-aggregate(cell_vol_log~stock, data = subset(dat,dat$oxygen==LineShift[i,1]&dat$temperature==LineShift[i,2]&dat$sex==LineShift[i,4]&dat$stock==LineShift[i,3]),median)[1,2]
LineShift$FM[i]<-aggregate(fresh_mass_log~stock, data = subset(dat,dat$oxygen==LineShift[i,1]&dat$temperature==LineShift[i,2]&dat$sex==LineShift[i,4]&dat$stock==LineShift[i,3]),median)[1,2]
}
LineShift<-data.frame(expand.grid(oxygen=c(10,21),
temperature=c(17,25),
LineID=levels(as.factor(dat$stock)),
sex=c("male","female")))
LineShift$CV<-NA
LineShift$FM<-NA
for (i in 1:12){
LineShift$CV[i]<-aggregate(cell_vol_log~stock, data = subset(dat,dat$oxygen==LineShift[i,1]&dat$temperature==LineShift[i,2]&dat$sex==LineShift[i,4]&dat$stock==LineShift[i,3]),median)[1,2]
LineShift$FM[i]<-aggregate(fresh_mass_log~stock, data = subset(dat,dat$oxygen==LineShift[i,1]&dat$temperature==LineShift[i,2]&dat$sex==LineShift[i,4]&dat$stock==LineShift[i,3]),median)[1,2]
}
for (i in 1:12){
LineShift$CV[i]<-aggregate(cell_area_~stock, data = subset(dat,dat$oxygen==LineShift[i,1]&dat$temperature==LineShift[i,2]&dat$sex==LineShift[i,4]&dat$stock==LineShift[i,3]),median)[1,2]
LineShift$FM[i]<-aggregate(fresh_mass_log~stock, data = subset(dat,dat$oxygen==LineShift[i,1]&dat$temperature==LineShift[i,2]&dat$sex==LineShift[i,4]&dat$stock==LineShift[i,3]),median)[1,2]
}
LineShift$CV[i]<-aggregate(cell_area_log~stock, data = subset(dat,dat$oxygen==LineShift[i,1]&dat$temperature==LineShift[i,2]&dat$sex==LineShift[i,4]&dat$stock==LineShift[i,3]),median)[1,2]
LineShift$CV<-NA
LineShift$FM<-NA
for (i in 1:12){
LineShift$CV[i]<-aggregate(cell_area_log~stock, data = subset(dat,dat$oxygen==LineShift[i,1]&dat$temperature==LineShift[i,2]&dat$sex==LineShift[i,4]&dat$stock==LineShift[i,3]),median)[1,2]
LineShift$FM[i]<-aggregate(fresh_mass_log~stock, data = subset(dat,dat$oxygen==LineShift[i,1]&dat$temperature==LineShift[i,2]&dat$sex==LineShift[i,4]&dat$stock==LineShift[i,3]),median)[1,2]
}
for (i in 15:36){
LineShift$CV[i]<-aggregate(cell_area_log~stock, data = subset(dat,dat$oxygen==LineShift[i,1]&dat$temperature==LineShift[i,2]&dat$sex==LineShift[i,4]&dat$stock==LineShift[i,3]),median)[1,2]
LineShift$FM[i]<-aggregate(fresh_mass_log~stock, data = subset(dat,dat$oxygen==LineShift[i,1]&dat$temperature==LineShift[i,2]&dat$sex==LineShift[i,4]&dat$stock==LineShift[i,3]),median)[1,2]
}
for (i in 39:48){
LineShift$CV[i]<-aggregate(cell_area_log~stock, data = subset(dat,dat$oxygen==LineShift[i,1]&dat$temperature==LineShift[i,2]&dat$sex==LineShift[i,4]&dat$stock==LineShift[i,3]),median)[1,2]
LineShift$FM[i]<-aggregate(fresh_mass_log~stock, data = subset(dat,dat$oxygen==LineShift[i,1]&dat$temperature==LineShift[i,2]&dat$sex==LineShift[i,4]&dat$stock==LineShift[i,3]),median)[1,2]
}
hypo<-LineShift[which(LineShift$oxygen==10),]
names(hypo)[5:6]<-paste(names(hypo)[5:6],"hypo")
norm<-LineShift[which(LineShift$oxygen==21),]
names(norm)[5:6]<-paste(names(norm)[5:6],"norm")
OxyShift<-cbind(hypo,norm)
names(OxyShift) <- sub(" ", ".", names(OxyShift))
OxyShift$CV_delta<-10^(OxyShift$CV.hypo-OxyShift$CV.norm)
OxyShift$FM_delta<-10^(OxyShift$FM.hypo-OxyShift$FM.norm)
OxyShift$CN_delta<-10^((OxyShift$FM.hypo-OxyShift$FM.norm)-(OxyShift$CV.hypo-OxyShift$CV.norm))
a<-mean(na.omit(OxyShift$CV_delta))-1
b<-mean(na.omit(OxyShift$FM_delta))-1
c<-mean(na.omit(OxyShift$CN_delta))-1
barplot(100*c(a,c,b),main="%change from normoxia to hypoxia",col=c("green","orange","brown"),ylim=c(-40,75))
summary(lm(FM_delta~CV.norm+temperature,data=OxyShift))# large cell size does not buffers from changes in body mass?
summary(n<-lm(FM_delta~CV_delta+temperature,data=OxyShift))# changes in cell size lead to  changes in body mass?
visreg(n,"CV_delta",by="temperature",overlay=T,ylab="FM_delta",main="changes from norm to hypo")
abline(h=1,v=1,lty=2)
summary(n<-lm(FM_delta~CN_delta+temperature,data=OxyShift))# changes in cell number do not lead to  changes in body mass?
visreg(n,"CN_delta",by="temperature",overlay=T,ylab="FM_delta",main="changes from norm to hypo")
abline(h=1,v=1,lty=2)
summary(n<-lm(CV_delta~CN_delta+temperature,data=OxyShift))# decreases in  cell size are buffered by increases in cell number?
visreg(n,"CN_delta",by="temperature",overlay=T,ylab="CV_delta",main="changes from norm to hypo")
abline(h=1,v=1,lty=2)
cool<-LineShift[which(LineShift$temperature==17),]
names(cool)[5:6]<-paste(names(cool)[5:6],"cool")
warm<-LineShift[which(LineShift$temperature==25),]
names(warm)[5:6]<-paste(names(warm)[5:6],"warm")
TShift<-cbind(warm,cool)
names(TShift) <- sub(" ", ".", names(TShift))
TShift$CV_delta<-10^(TShift$CV.warm-TShift$CV.cool)
TShift$FM_delta<-10^(TShift$FM.warm-TShift$FM.cool)
TShift$CN_delta<-10^((TShift$FM.warm-TShift$FM.cool)-(TShift$CV.warm-TShift$CV.cool))
a<-mean(na.omit(TShift$CV_delta))-1
b<-mean(na.omit(TShift$FM_delta))-1
c<-mean(na.omit(TShift$CN_delta))-1
barplot(100*c(a,c,b),main="%change from cool to warm",col=c("green","orange","brown"),ylim=c(-40,75))
legend("bottomright",c("cell area","cell number","freshmass"),fill=c("green","orange","brown"))
summary(lm(FM_delta~CV.cool,data=TShift))# cell size does not affect changes in body mass?
summary(n<-lm(FM_delta~CV_delta+oxygen,data=TShift))# changes in cell size do not lead to  changes in body mass?
visreg(n,"CV_delta",by="oxygen",overlay=T,ylab="FM_delta",main="changes from cool to warm")
abline(h=1,v=1,lty=2)
summary(n<-lm(FM_delta~CN_delta+oxygen,data=TShift))# changes in cell number do lead to  changes in body mass?
visreg(n,"CN_delta",by="oxygen",overlay=T,ylab="FM_delta",main="changes from cool to warm")
abline(h=1,v=1,lty=2)
summary(n<-lm(CV_delta~CN_delta+oxygen,data=TShift))# decreases in  cell size are buffered by increases in cell number?
visreg(n,"CN_delta",by="oxygen",overlay=T,ylab="CV_delta",main="changes from cool to warm")
abline(h=1,v=1,lty=2)
m<-lmer(fresh_mass_log~cell_vol_log*(oxygen+temperature)+sex+(1|stock),data=dat)
visreg(m,"cell_vol_log",by= "oxygen",overlay=T,ylim=c(-0.3,0.2),cond=list(sex="male"))
abline(a=-7.3,b=1,col="#00000060",lty=2,lwd=2)
for (i in 1:6){
colortype<-c("red","red","blue","purple","blue","purple")
bgcol<-c("red","white","blue","purple","white","white")
j<-i*2-1
points(c(OxyShift$CV.norm[j],OxyShift$CV.hypo[j]),c(OxyShift$FM.norm[j],OxyShift$FM.hypo[j]),pch=c(21,25),col=colortype[i],bg=bgcol[i])
lines(c(OxyShift$CV.norm[j],OxyShift$CV.hypo[j]),c(OxyShift$FM.norm[j],OxyShift$FM.hypo[j]),col=colortype[i],lwd=2)
j<-j+1
points(c(OxyShift$CV.norm[j],OxyShift$CV.hypo[j]),c(OxyShift$FM.norm[j],OxyShift$FM.hypo[j]),pch=c(21,25),col=colortype[i],bg=bgcol[i])
lines(c(OxyShift$CV.norm[j],OxyShift$CV.hypo[j]),c(OxyShift$FM.norm[j],OxyShift$FM.hypo[j]),col=colortype[i],lty=2,lwd=2)
}
visreg(m,"cell_vol_log",by= "oxygen",overlay=T,ylim=c(-0.4,0.2),cond=list(sex="female"))
abline(a=-7.3,b=1,col="#00000060",lty=2,lwd=2)
for (i in 1:6){
colortype<-c("red","red","blue","purple","blue","purple")
bgcol<-c("red","white","blue","purple","white","white")
j<-i*2-1+12
points(c(OxyShift$CV.norm[j],OxyShift$CV.hypo[j]),c(OxyShift$FM.norm[j],OxyShift$FM.hypo[j]),pch=c(21,25),col=colortype[i],bg=bgcol[i])
lines(c(OxyShift$CV.norm[j],OxyShift$CV.hypo[j]),c(OxyShift$FM.norm[j],OxyShift$FM.hypo[j]),col=colortype[i],lwd=2)
j<-j+1
points(c(OxyShift$CV.norm[j],OxyShift$CV.hypo[j]),c(OxyShift$FM.norm[j],OxyShift$FM.hypo[j]),pch=c(21,25),col=colortype[i],bg=bgcol[i])
lines(c(OxyShift$CV.norm[j],OxyShift$CV.hypo[j]),c(OxyShift$FM.norm[j],OxyShift$FM.hypo[j]),col=colortype[i],lty=2,lwd=2)
}
legend("bottomright",c("median normoxia","median hypoxia","large","medium","small","17C","25C"),pch=c(21,25,NA,NA,NA,NA,NA),
lty=c(NA,NA,1,1,1,1,2),lwd=2,col=c("black","black","blue","purple","red","black","black"),bty="n")
visreg(m,"cell_vol_log",by= "temperature",overlay=T,ylim=c(-0.3,0.2),cond=list(sex="male"))
abline(a=-7.3,b=1,col="#00000060",lty=2,lwd=2)
for (i in 1:6){
colortype<-c("red","red","blue","purple","blue","purple")
bgcol<-c("red","white","blue","purple","white","white")
j<-i*2-1
points(c(TShift$CV.cool[j],TShift$CV.warm[j]),c(TShift$FM.cool[j],TShift$FM.warm[j]),pch=c(21,25),col=colortype[i],bg=bgcol[i])
lines(c(TShift$CV.cool[j],TShift$CV.warm[j]),c(TShift$FM.cool[j],TShift$FM.warm[j]),col=colortype[i],lty=2,lwd=2)
j<-j+1
points(c(TShift$CV.cool[j],TShift$CV.warm[j]),c(TShift$FM.cool[j],TShift$FM.warm[j]),pch=c(21,25),col=colortype[i],bg=bgcol[i])
lines(c(TShift$CV.cool[j],TShift$CV.warm[j]),c(TShift$FM.cool[j],TShift$FM.warm[j]),col=colortype[i],lwd=2)
}
visreg(m,"cell_vol_log",by= "temperature",overlay=T,ylim=c(-0.3,0.2),cond=list(sex="female"))
for (i in 1:6){
colortype<-c("red","red","blue","purple","blue","purple")
bgcol<-c("red","white","blue","purple","white","white")
j<-i*2-1+12
points(c(TShift$CV.cool[j],TShift$CV.warm[j]),c(TShift$FM.cool[j],TShift$FM.warm[j]),pch=c(21,25),col=colortype[i],bg=bgcol[i])
lines(c(TShift$CV.cool[j],TShift$CV.warm[j]),c(TShift$FM.cool[j],TShift$FM.warm[j]),col=colortype[i],lty=2,lwd=2)
j<-j+1
points(c(TShift$CV.cool[j],TShift$CV.warm[j]),c(TShift$FM.cool[j],TShift$FM.warm[j]),pch=c(21,25),col=colortype[i],bg=bgcol[i])
lines(c(TShift$CV.cool[j],TShift$CV.warm[j]),c(TShift$FM.cool[j],TShift$FM.warm[j]),col=colortype[i],lwd=2)
}
legend("bottomright",c("median cool","median warm","large","medium","small","normoxia","hypoxia"),pch=c(21,25,NA,NA,NA,NA,NA),
lty=c(NA,NA,1,1,1,1,2),lwd=2,col=c("black","black","blue","purple","red","black","black"),bty="n")
################################################################################
# Figure 5
################################################################################
setwd("../Outputs/")#Set directory
{
#pdf("4.2.1. Figure 5.pdf",width = 10,height = 5,useDingbats = FALSE)
png("4.2.1. Figure 5.png",width = 10,height = 5,units = "in",res = 600)
par(mfrow=c(1,2),tcl=-0.4, family="serif",omi=c(0,0,0,0.1))
# TEMPERATURE
par(mai=c(0.86,0.85,0,0))
visreg(m,"cell_area_log",by="temperature",overlay=TRUE,
print.cond=TRUE,legend = FALSE,
points=list(col=c("#2c7fb870", "#de2d2670"),pch=16,cex=1.5),
line=list(col=c("#2c7fb8", "#de2d26"), lwd=5),
xlab=expression(paste(log[10], "[cell area (",mu, m^2,")]")),
ylab=expression(paste(log[10],"[fresh mass (mg)]")),
ylim=c(-0.4,0.1),xlim=c(1.9,2.4),
cex.axis=1.2,cex.lab=1.4)
legend("bottomright", legend=c("17°C", "25°C"),
lty = 1,lwd=4, bty="n",
col=c("#2c7fb8", "#de2d26"),cex=1.4)
# OXYGEN
par(mai=c(0.85,0.82,0,0))
visreg(m,"cell_area_log",by="oxygen",overlay=TRUE,
print.cond=TRUE,legend = FALSE,
points=list(col=c("#E6610170", "#00AFBB70"),pch=16,cex=1.5),
line=list(col=c("#E66101", "#00AFBB"), lwd=5),
xlab=expression(paste(log[10], "[cell area (",mu, m^2,")]")),
ylab=expression(paste(log[10],"[fresh mass (mg)]")),
ylim=c(-0.4,0.1),xlim=c(1.9,2.4),
cex.axis=1.2,cex.lab=1.4)
legend("bottomright", legend=c("10 kPa", "21 kPa"),
lty = 1,lwd=4, bty="n",
col=c("#E66101", "#00AFBB"),cex=1.4)
dev.off()
}
{
#pdf("4.2.1. Figure 5.pdf",width = 10,height = 5,useDingbats = FALSE)
png("4.2.1. Figure 5.png",width = 10,height = 5,units = "in",res = 600)
par(mfrow=c(1,2),tcl=-0.4, family="serif",omi=c(0,0,0,0.1))
# TEMPERATURE
par(mai=c(0.85,0.85,0,0))
visreg(m,"cell_area_log",by="temperature",overlay=TRUE,
print.cond=TRUE,legend = FALSE,
points=list(col=c("#2c7fb870", "#de2d2670"),pch=16,cex=1.5),
line=list(col=c("#2c7fb8", "#de2d26"), lwd=5),
xlab=expression(paste(log[10], "[cell area (",mu, m^2,")]")),
ylab=expression(paste(log[10],"[fresh mass (mg)]")),
ylim=c(-0.4,0.1),xlim=c(1.9,2.4),
cex.axis=1.2,cex.lab=1.4)
legend("bottomright", legend=c("17°C", "25°C"),
lty = 1,lwd=4, bty="n",
col=c("#2c7fb8", "#de2d26"),cex=1.4)
# OXYGEN
par(mai=c(0.85,0.85,0,0))
visreg(m,"cell_area_log",by="oxygen",overlay=TRUE,
print.cond=TRUE,legend = FALSE,
points=list(col=c("#E6610170", "#00AFBB70"),pch=16,cex=1.5),
line=list(col=c("#E66101", "#00AFBB"), lwd=5),
xlab=expression(paste(log[10], "[cell area (",mu, m^2,")]")),
ylab=expression(paste(log[10],"[fresh mass (mg)]")),
ylim=c(-0.4,0.1),xlim=c(1.9,2.4),
cex.axis=1.2,cex.lab=1.4)
legend("bottomright", legend=c("10 kPa", "21 kPa"),
lty = 1,lwd=4, bty="n",
col=c("#E66101", "#00AFBB"),cex=1.4)
dev.off()
}
{
#pdf("4.2.1. Figure 5.pdf",width = 10,height = 5,useDingbats = FALSE)
png("4.2.1. Figure 5.png",width = 10,height = 5,units = "in",res = 600)
par(mfrow=c(1,2),tcl=-0.4, family="serif",omi=c(0,0,0,0.1))
# TEMPERATURE
par(mai=c(0.85,0.87,0,0))
visreg(m,"cell_area_log",by="temperature",overlay=TRUE,
print.cond=TRUE,legend = FALSE,
points=list(col=c("#2c7fb870", "#de2d2670"),pch=16,cex=1.5),
line=list(col=c("#2c7fb8", "#de2d26"), lwd=5),
xlab=expression(paste(log[10], "[cell area (",mu, m^2,")]")),
ylab=expression(paste(log[10],"[fresh mass (mg)]")),
ylim=c(-0.4,0.1),xlim=c(1.9,2.4),
cex.axis=1.2,cex.lab=1.4)
legend("bottomright", legend=c("17°C", "25°C"),
lty = 1,lwd=4, bty="n",
col=c("#2c7fb8", "#de2d26"),cex=1.4)
# OXYGEN
par(mai=c(0.85,0.87,0,0))
visreg(m,"cell_area_log",by="oxygen",overlay=TRUE,
print.cond=TRUE,legend = FALSE,
points=list(col=c("#E6610170", "#00AFBB70"),pch=16,cex=1.5),
line=list(col=c("#E66101", "#00AFBB"), lwd=5),
xlab=expression(paste(log[10], "[cell area (",mu, m^2,")]")),
ylab=expression(paste(log[10],"[fresh mass (mg)]")),
ylim=c(-0.4,0.1),xlim=c(1.9,2.4),
cex.axis=1.2,cex.lab=1.4)
legend("bottomright", legend=c("10 kPa", "21 kPa"),
lty = 1,lwd=4, bty="n",
col=c("#E66101", "#00AFBB"),cex=1.4)
dev.off()
}
{
#pdf("4.2.1. Figure 5.pdf",width = 10,height = 5,useDingbats = FALSE)
png("4.2.1. Figure 5.png",width = 10,height = 5,units = "in",res = 600)
par(mfrow=c(1,2),tcl=-0.4, family="serif",omi=c(0,0,0,0.1))
# TEMPERATURE
par(mai=c(0.85,0.87,0,0.2))
visreg(m,"cell_area_log",by="temperature",overlay=TRUE,
print.cond=TRUE,legend = FALSE,
points=list(col=c("#2c7fb870", "#de2d2670"),pch=16,cex=1.5),
line=list(col=c("#2c7fb8", "#de2d26"), lwd=5),
xlab=expression(paste(log[10], "[cell area (",mu, m^2,")]")),
ylab=expression(paste(log[10],"[fresh mass (mg)]")),
ylim=c(-0.4,0.1),xlim=c(1.9,2.4),
cex.axis=1.2,cex.lab=1.4)
legend("bottomright", legend=c("17°C", "25°C"),
lty = 1,lwd=4, bty="n",
col=c("#2c7fb8", "#de2d26"),cex=1.4)
# OXYGEN
par(mai=c(0.85,0.87,0,0.2))
visreg(m,"cell_area_log",by="oxygen",overlay=TRUE,
print.cond=TRUE,legend = FALSE,
points=list(col=c("#E6610170", "#00AFBB70"),pch=16,cex=1.5),
line=list(col=c("#E66101", "#00AFBB"), lwd=5),
xlab=expression(paste(log[10], "[cell area (",mu, m^2,")]")),
ylab=expression(paste(log[10],"[fresh mass (mg)]")),
ylim=c(-0.4,0.1),xlim=c(1.9,2.4),
cex.axis=1.2,cex.lab=1.4)
legend("bottomright", legend=c("10 kPa", "21 kPa"),
lty = 1,lwd=4, bty="n",
col=c("#E66101", "#00AFBB"),cex=1.4)
dev.off()
}
################################################################################
# Figure 5
################################################################################
setwd("../Outputs/")#Set directory
{
#pdf("4.2.1. Figure 5.pdf",width = 10,height = 5,useDingbats = FALSE)
png("4.2.1. Figure 5.png",width = 10,height = 5,units = "in",res = 600)
par(mfrow=c(1,2),tcl=-0.4, family="serif",omi=c(0,0,0,0.1))
# TEMPERATURE
par(mai=c(0.85,0.87,0.1,0.1))
visreg(m,"cell_area_log",by="temperature",overlay=TRUE,
print.cond=TRUE,legend = FALSE,
points=list(col=c("#2c7fb870", "#de2d2670"),pch=16,cex=1.5),
line=list(col=c("#2c7fb8", "#de2d26"), lwd=5),
xlab=expression(paste(log[10], "[cell area (",mu, m^2,")]")),
ylab=expression(paste(log[10],"[fresh mass (mg)]")),
ylim=c(-0.4,0.1),xlim=c(1.9,2.4),
cex.axis=1.2,cex.lab=1.4)
legend("bottomright", legend=c("17°C", "25°C"),
lty = 1,lwd=4, bty="n",
col=c("#2c7fb8", "#de2d26"),cex=1.4)
# OXYGEN
par(mai=c(0.85,0.87,0.1,0.1))
visreg(m,"cell_area_log",by="oxygen",overlay=TRUE,
print.cond=TRUE,legend = FALSE,
points=list(col=c("#E6610170", "#00AFBB70"),pch=16,cex=1.5),
line=list(col=c("#E66101", "#00AFBB"), lwd=5),
xlab=expression(paste(log[10], "[cell area (",mu, m^2,")]")),
ylab=expression(paste(log[10],"[fresh mass (mg)]")),
ylim=c(-0.4,0.1),xlim=c(1.9,2.4),
cex.axis=1.2,cex.lab=1.4)
legend("bottomright", legend=c("10 kPa", "21 kPa"),
lty = 1,lwd=4, bty="n",
col=c("#E66101", "#00AFBB"),cex=1.4)
dev.off()
}
#model
m<-lmer(fresh_mass_log ~ (temperature + oxygen) * cell_area_log + sex + (1|stock),data=dat)
summary(m)
Anova(m)
LineShift<-data.frame(expand.grid(oxygen=c(10,21),
temperature=c(17,25),
LineID=levels(as.factor(dat$stock)),
sex=c("female","male")))
LineShift$CA<-NA
LineShift$FM<-NA
for (i in 1:12){
LineShift$CA[i]<-aggregate(cell_area_log~stock, data = subset(dat,dat$oxygen==LineShift[i,1]&dat$temperature==LineShift[i,2]&dat$sex==LineShift[i,4]&dat$stock==LineShift[i,3]),median)[1,2]
LineShift$FM[i]<-aggregate(fresh_mass_log~stock, data = subset(dat,dat$oxygen==LineShift[i,1]&dat$temperature==LineShift[i,2]&dat$sex==LineShift[i,4]&dat$stock==LineShift[i,3]),median)[1,2]
}
for (i in 15:36){
LineShift$CA[i]<-aggregate(cell_area_log~stock, data = subset(dat,dat$oxygen==LineShift[i,1]&dat$temperature==LineShift[i,2]&dat$sex==LineShift[i,4]&dat$stock==LineShift[i,3]),median)[1,2]
LineShift$FM[i]<-aggregate(fresh_mass_log~stock, data = subset(dat,dat$oxygen==LineShift[i,1]&dat$temperature==LineShift[i,2]&dat$sex==LineShift[i,4]&dat$stock==LineShift[i,3]),median)[1,2]
}
for (i in 39:48){
LineShift$CA[i]<-aggregate(cell_area_log~stock, data = subset(dat,dat$oxygen==LineShift[i,1]&dat$temperature==LineShift[i,2]&dat$sex==LineShift[i,4]&dat$stock==LineShift[i,3]),median)[1,2]
LineShift$FM[i]<-aggregate(fresh_mass_log~stock, data = subset(dat,dat$oxygen==LineShift[i,1]&dat$temperature==LineShift[i,2]&dat$sex==LineShift[i,4]&dat$stock==LineShift[i,3]),median)[1,2]
}
hypo<-LineShift[which(LineShift$oxygen==10),]
names(hypo)[5:6]<-paste(names(hypo)[5:6],"hypo")
norm<-LineShift[which(LineShift$oxygen==21),]
names(norm)[5:6]<-paste(names(norm)[5:6],"norm")
OxyShift<-cbind(hypo,norm)
names(OxyShift) <- sub(" ", ".", names(OxyShift))
OxyShift$CA_delta<-10^(OxyShift$CA.hypo-OxyShift$CA.norm)
OxyShift$FM_delta<-10^(OxyShift$FM.hypo-OxyShift$FM.norm)
OxyShift$CN_delta<-10^((OxyShift$FM.hypo-OxyShift$FM.norm)-(OxyShift$CA.hypo-OxyShift$CA.norm))
a<-mean(na.omit(OxyShift$CA_delta))-1
b<-mean(na.omit(OxyShift$FM_delta))-1
c<-mean(na.omit(OxyShift$CN_delta))-1
barplot(100*c(a,c,b),main="%change from normoxia to hypoxia",col=c("green","orange","brown"),ylim=c(-40,75))
