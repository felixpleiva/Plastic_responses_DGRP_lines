m_inter_general_10 <- summary(m5_10)$coefficients[1, 1]
m_slope_temp_10     <- summary(m5_10)$coefficients[2, 1]
m_slope_oxy_10      <- summary(m5_10)$coefficients[3, 1]
m_slope_sex_10      <- summary(m5_10)$coefficients[6, 1]
m_slope_temp_oxy_10 <- summary(m5_10)$coefficients[7, 1]
x <- c(17,25)
ylarge_m_10 <- c(m_inter_general_10 + m_slope_temp_10 * x + m_slope_oxy_10 * 10 + m_slope_sex_10 + m_slope_temp_oxy_10 * 10 * x)
#Medium celled-lines
m5_10<-lmer(fresh_mass_log ~ temperature * oxygen * relevel(as.factor(cell_area_cat),ref="medium") +  sex + (1|stock), data=dat)
m_inter_general_10 <- summary(m5_10)$coefficients[1, 1]
m_slope_temp_10     <- summary(m5_10)$coefficients[2, 1]
m_slope_oxy_10      <- summary(m5_10)$coefficients[3, 1]
m_slope_sex_10      <- summary(m5_10)$coefficients[6, 1]
m_slope_temp_oxy_10 <- summary(m5_10)$coefficients[7, 1]
ymedium_m_10 <- c(m_inter_general_10 + m_slope_temp_10 * x + m_slope_oxy_10 * 10 + m_slope_sex_10 + m_slope_temp_oxy_10 * 10 * x)
#Small celled-lines
m5_10<-lmer(fresh_mass_log ~ temperature * oxygen * relevel(as.factor(cell_area_cat),ref="small") +  sex + (1|stock), data=dat)
m_inter_general_10 <- summary(m5_10)$coefficients[1, 1]
m_slope_temp_10     <- summary(m5_10)$coefficients[2, 1]
m_slope_oxy_10      <- summary(m5_10)$coefficients[3, 1]
m_slope_sex_10      <- summary(m5_10)$coefficients[6, 1]
m_slope_temp_oxy_10 <- summary(m5_10)$coefficients[7, 1]
ysmall_m_10 <- c(m_inter_general_10 + m_slope_temp_10 * x + m_slope_oxy_10 * 10 + m_slope_sex_10 + m_slope_temp_oxy_10 * 10 * x)
plot_a<-visreg(m5,'temperature', by='cell_area_cat',cond = list(oxygen=10),
print.cond=TRUE,overlay=TRUE,jitter=0.1,legend = FALSE)
#-------------------------------------------------------------------------------
x <- c(17,25)
m5_21<-lmer(fresh_mass_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock), data=dat)
# Extract slopes per predictor for fresh mass model (NORMOXIA)
#Large celled-lines
m_inter_general_21 <- summary(m5_21)$coefficients[1, 1]
m_slope_temp_21     <- summary(m5_21)$coefficients[2, 1]
m_slope_oxy_21      <- summary(m5_21)$coefficients[3, 1]
m_slope_sex_21      <- summary(m5_21)$coefficients[6, 1]
m_slope_temp_oxy_21 <- summary(m5_21)$coefficients[7, 1]
ylarge_m_21 <- c(m_inter_general_21 + m_slope_temp_21 * x + m_slope_oxy_21 * 21 + m_slope_sex_21 + m_slope_temp_oxy_21 * 21 * x)
#Medium celled-lines
m5_21<-lmer(fresh_mass_log ~ temperature * oxygen * relevel(as.factor(cell_area_cat),ref="medium") +  sex + (1|stock), data=dat)
m_inter_general_21 <- summary(m5_21)$coefficients[1, 1]
m_slope_temp_21    <- summary(m5_21)$coefficients[2, 1]
m_slope_oxy_21      <- summary(m5_21)$coefficients[3, 1]
m_slope_sex_21      <- summary(m5_21)$coefficients[6, 1]
m_slope_temp_oxy_21 <- summary(m5_21)$coefficients[7, 1]
ymedium_m_21 <- c(m_inter_general_21 + m_slope_temp_21 * x + m_slope_oxy_21 * 21 + m_slope_sex_21 + m_slope_temp_oxy_21 * 21 * x)
#Small celled-lines
m5_21<-lmer(fresh_mass_log ~ temperature * oxygen * relevel(as.factor(cell_area_cat),ref="small") +  sex + (1|stock), data=dat)
m_inter_general_21 <- summary(m5_21)$coefficients[1, 1]
m_slope_temp_21     <- summary(m5_21)$coefficients[2, 1]
m_slope_oxy_21      <- summary(m5_21)$coefficients[3, 1]
m_slope_sex_21      <- summary(m5_21)$coefficients[6, 1]
m_slope_temp_oxy_21 <- summary(m5_21)$coefficients[7, 1]
ysmall_m_21 <- c(m_inter_general_21 + m_slope_temp_21 * x + m_slope_oxy_21 * 21 + m_slope_sex_21 + m_slope_temp_oxy_21 * 21 * x)
plot_b<-visreg(m5,'temperature', by='cell_area_cat',cond = list(oxygen=21),
print.cond=TRUE,overlay=TRUE,jitter=0.1,legend = FALSE)
#-------------------------------------------------------------------------------
#Large celled-lines
w5_10<-lmer(wing_area_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock), data=dat)
# Extract general and random intercepts for wing area model
w_int_25180     <- ranef(w5_10)$stock[1,1]# small
w_int_25182     <- ranef(w5_10)$stock[2,1]# small
w_int_28141     <- ranef(w5_10)$stock[4,1]# medium
w_int_28247     <- ranef(w5_10)$stock[6,1]# medium
w_int_28196     <- ranef(w5_10)$stock[5,1]# large
w_int_25203     <- ranef(w5_10)$stock[3,1]# large
# Extract slopes per predictor for fresh mass model
w_inter_general_10 <- summary(w5_10)$coefficients[1, 1]
w_slope_temp_10     <- summary(w5_10)$coefficients[2, 1]
w_slope_oxy_10      <- summary(w5_10)$coefficients[3, 1]
w_slope_sex_10      <- summary(w5_10)$coefficients[6, 1]
w_slope_temp_oxy_10 <- summary(w5_10)$coefficients[7, 1]
x <- c(17,25)
ylarge_w_10 <- c(w_inter_general_10 + w_slope_temp_10 * x + w_slope_oxy_10 * 10 + w_slope_sex_10 + w_slope_temp_oxy_10 * 10 * x)
#Medium celled-lines
w5_10<-lmer(wing_area_log ~ temperature * oxygen * relevel(as.factor(cell_area_cat),ref="medium") +  sex + (1|stock), data=dat)
w_inter_general_10 <- summary(w5_10)$coefficients[1, 1]
w_slope_temp_10     <- summary(w5_10)$coefficients[2, 1]
w_slope_oxy_10      <- summary(w5_10)$coefficients[3, 1]
w_slope_sex_10      <- summary(w5_10)$coefficients[6, 1]
w_slope_temp_oxy_10 <- summary(w5_10)$coefficients[7, 1]
ymedium_w_10 <- c(w_inter_general_10 + w_slope_temp_10 * x + w_slope_oxy_10 * 10 + w_slope_sex_10 + w_slope_temp_oxy_10 * 10 * x)
#Small celled-lines
w5_10<-lmer(wing_area_log ~ temperature * oxygen * relevel(as.factor(cell_area_cat),ref="small") +  sex + (1|stock), data=dat)
w_inter_general_10 <- summary(w5_10)$coefficients[1, 1]
w_slope_temp_10     <- summary(w5_10)$coefficients[2, 1]
w_slope_oxy_10      <- summary(w5_10)$coefficients[3, 1]
w_slope_sex_10      <- summary(w5_10)$coefficients[6, 1]
w_slope_temp_oxy_10 <- summary(w5_10)$coefficients[7, 1]
ysmall_w_10 <- c(w_inter_general_10 + w_slope_temp_10 * x + w_slope_oxy_10 * 10 + w_slope_sex_10 + w_slope_temp_oxy_10 * 10 * x)
plot_c<-visreg(w5,'temperature', by='cell_area_cat',cond = list(oxygen=10),
print.cond=TRUE,overlay=TRUE,jitter=0.1,legend = FALSE)
#-------------------------------------------------------------------------------
x <- c(17,25)
w5_21<-lmer(wing_area_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock), data=dat)
# Extract slopes per predictor for fresh mass model (NORMOXIA)
#Large celled-lines
w_inter_general_21 <- summary(w5_21)$coefficients[1, 1]
w_slope_temp_21     <- summary(w5_21)$coefficients[2, 1]
w_slope_oxy_21      <- summary(w5_21)$coefficients[3, 1]
w_slope_sex_21      <- summary(w5_21)$coefficients[6, 1]
w_slope_temp_oxy_21 <- summary(w5_21)$coefficients[7, 1]
ylarge_w_21 <- c(w_inter_general_21 + w_slope_temp_21 * x + w_slope_oxy_21 * 21 + w_slope_sex_21 + w_slope_temp_oxy_21 * 21 * x)
#Medium celled-lines
w5_21<-lmer(wing_area_log ~ temperature * oxygen * relevel(as.factor(cell_area_cat),ref="medium") +  sex + (1|stock), data=dat)
w_inter_general_21 <- summary(w5_21)$coefficients[1, 1]
w_slope_temp_21    <- summary(w5_21)$coefficients[2, 1]
w_slope_oxy_21      <- summary(w5_21)$coefficients[3, 1]
w_slope_sex_21      <- summary(w5_21)$coefficients[6, 1]
w_slope_temp_oxy_21 <- summary(w5_21)$coefficients[7, 1]
ymedium_w_21 <- c(w_inter_general_21 + w_slope_temp_21 * x + w_slope_oxy_21 * 21 + w_slope_sex_21 + w_slope_temp_oxy_21 * 21 * x)
#Small celled-lines
w5_21<-lmer(wing_area_log ~ temperature * oxygen * relevel(as.factor(cell_area_cat),ref="small") +  sex + (1|stock), data=dat)
w_inter_general_21  <- summary(w5_21)$coefficients[1, 1]
w_slope_temp_21     <- summary(w5_21)$coefficients[2, 1]
w_slope_oxy_21      <- summary(w5_21)$coefficients[3, 1]
w_slope_sex_21      <- summary(w5_21)$coefficients[6, 1]
w_slope_temp_oxy_21 <- summary(w5_21)$coefficients[7, 1]
ysmall_w_21 <- c(w_inter_general_21 + w_slope_temp_21 * x + w_slope_oxy_21 * 21 + w_slope_sex_21 + w_slope_temp_oxy_21 * 21 * x)
plot_d<-visreg(w5,'temperature', by='cell_area_cat',cond = list(oxygen=21),
print.cond=TRUE,overlay=TRUE,jitter=0.1,legend = FALSE)
#-------------------------------------------------------------------------------
#Large celled-lines
c5_10<-lmer(cell_area_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock), data=dat)
# Extract general and random intercepts for fresh mass model
c_int_25180     <- ranef(c5_10)$stock[1,1]# small
c_int_25182     <- ranef(c5_10)$stock[2,1]# small
c_int_28141     <- ranef(c5_10)$stock[4,1]# medium
c_int_28247     <- ranef(c5_10)$stock[6,1]# medium
c_int_28196     <- ranef(c5_10)$stock[5,1]# large
c_int_25203     <- ranef(c5_10)$stock[3,1]# large
# Extract slopes per predictor for fresh mass model
c_inter_general_10 <- summary(c5_10)$coefficients[1, 1]
c_slope_temp_10     <- summary(c5_10)$coefficients[2, 1]
c_slope_oxy_10      <- summary(c5_10)$coefficients[3, 1]
c_slope_sex_10      <- summary(c5_10)$coefficients[6, 1]
c_slope_temp_oxy_10 <- summary(c5_10)$coefficients[7, 1]
x <- c(17,25)
ylarge_c_10 <- c(c_inter_general_10 + c_slope_temp_10 * x + c_slope_oxy_10 * 10 + c_slope_sex_10 + c_slope_temp_oxy_10 * 10 * x)
#Medium celled-lines
c5_10<-lmer(cell_area_log ~ temperature * oxygen * relevel(as.factor(cell_area_cat),ref="medium") +  sex + (1|stock), data=dat)
c_inter_general_10 <- summary(c5_10)$coefficients[1, 1]
c_slope_temp_10     <- summary(c5_10)$coefficients[2, 1]
c_slope_oxy_10      <- summary(c5_10)$coefficients[3, 1]
c_slope_sex_10      <- summary(c5_10)$coefficients[6, 1]
c_slope_temp_oxy_10 <- summary(c5_10)$coefficients[7, 1]
ymedium_c_10 <- c(c_inter_general_10 + c_slope_temp_10 * x + c_slope_oxy_10 * 10 + c_slope_sex_10 + c_slope_temp_oxy_10 * 10 * x)
#Small celled-lines
c5_10<-lmer(cell_area_log ~ temperature * oxygen * relevel(as.factor(cell_area_cat),ref="small") +  sex + (1|stock), data=dat)
c_inter_general_10  <- summary(c5_10)$coefficients[1, 1]
c_slope_temp_10     <- summary(c5_10)$coefficients[2, 1]
c_slope_oxy_10      <- summary(c5_10)$coefficients[3, 1]
c_slope_sex_10      <- summary(c5_10)$coefficients[6, 1]
c_slope_temp_oxy_10 <- summary(c5_10)$coefficients[7, 1]
ysmall_c_10 <- c(c_inter_general_10 + c_slope_temp_10 * x + c_slope_oxy_10 * 10 + c_slope_sex_10 + c_slope_temp_oxy_10 * 10 * x)
plot_e<-visreg(c5,'temperature', by='cell_area_cat',cond = list(oxygen=10),
print.cond=TRUE,overlay=TRUE,jitter=0.1,legend = FALSE)
#-------------------------------------------------------------------------------
#Large celled-lines
c5_21<-lmer(cell_area_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock), data=dat)
# Extract general and random intercepts for fresh mass model
c_int_25180_21     <- ranef(c5_21)$stock[1,1]# small
c_int_25182_21     <- ranef(c5_21)$stock[2,1]# small
c_int_28141_21     <- ranef(c5_21)$stock[4,1]# medium
c_int_28247_21     <- ranef(c5_21)$stock[6,1]# medium
c_int_28196_21     <- ranef(c5_21)$stock[5,1]# large
c_int_25203_21     <- ranef(c5_21)$stock[3,1]# large
# Extract slopes per predictor for fresh mass model
c_inter_general_21 <- summary(c5_21)$coefficients[1, 1]
c_slope_temp_21     <- summary(c5_21)$coefficients[2, 1]
c_slope_oxy_21      <- summary(c5_21)$coefficients[3, 1]
c_slope_sex_21      <- summary(c5_21)$coefficients[6, 1]
c_slope_temp_oxy_21 <- summary(c5_21)$coefficients[7, 1]
x <- c(17,25)
ylarge_c_21 <- c(c_inter_general_21 + c_slope_temp_21 * x + c_slope_oxy_21 * 21 + c_slope_sex_21 + c_slope_temp_oxy_21 * 21 * x)
#Medium celled-lines
c5_21<-lmer(cell_area_log ~ temperature * oxygen * relevel(as.factor(cell_area_cat),ref="medium") +  sex + (1|stock), data=dat)
c_inter_general_21 <- summary(c5_21)$coefficients[1, 1]
c_slope_temp_21     <- summary(c5_21)$coefficients[2, 1]
c_slope_oxy_21      <- summary(c5_21)$coefficients[3, 1]
c_slope_sex_21      <- summary(c5_21)$coefficients[6, 1]
c_slope_temp_oxy_21 <- summary(c5_21)$coefficients[7, 1]
ymedium_c_21 <- c(c_inter_general_21 + c_slope_temp_21 * x + c_slope_oxy_21 * 21 + c_slope_sex_21 + c_slope_temp_oxy_21 * 21 * x)
#Small celled-lines
c5_21<-lmer(cell_area_log ~ temperature * oxygen * relevel(as.factor(cell_area_cat),ref="small") +  sex + (1|stock), data=dat)
c_inter_general_21  <- summary(c5_21)$coefficients[1, 1]
c_slope_temp_21     <- summary(c5_21)$coefficients[2, 1]
c_slope_oxy_21      <- summary(c5_21)$coefficients[3, 1]
c_slope_sex_21      <- summary(c5_21)$coefficients[6, 1]
c_slope_temp_oxy_21 <- summary(c5_21)$coefficients[7, 1]
ysmall_c_21 <- c(c_inter_general_21 + c_slope_temp_21 * x + c_slope_oxy_21 * 21 + c_slope_sex_21 + c_slope_temp_oxy_21 * 21 * x)
plot_f<-visreg(c5,'temperature', by='cell_area_cat',cond = list(oxygen=21),
print.cond=TRUE,overlay=TRUE,jitter=0.1,legend = FALSE)
#-------------------------------------------------------------------------------
# Figure 2
setwd("../Outputs/")
{
#pdf("2.2.1. Figure 2.1.pdf",width = 7,height = 10,useDingbats = FALSE)
png("2.2.1. Figure 2.1.png",width = 7,height = 10,units = "in",res = 600)
par(mfrow=c(3,2),tcl=-0.4, family="serif",omi=c(0,0,0,0.1))
par(mai=c(0.85,0.82,0,0))
plot(10^visregRes ~temperature,data=plot_a$res,
pch=16,cex=1.5,col=c('#B8860B70','#6495ED70','#B2ABD270')[as.factor(cell_area_cat)],
xlab="temperature (°C)",
ylab="fresh mass (mg)",
ylim=c(0.4,1.2),
las = 1,
xaxt="n",
cex.axis=1.2,cex.lab=1.4)
#update axis
axis(1,at=c(17,25), labels=c("17","25"),cex.axis=1.2)
#Add lines per cell size category
lines(x,(10^ylarge_m_10),col="#B8860B",lwd=4)
lines(x,(10^ymedium_m_10),col="#6495ED",lwd=4)
lines(x,(10^ysmall_m_10),col="#B2ABD2",lwd=4)
#Add lines per stock
lines(x,(10^ylarge_m_10 + m_int_28196), col='#B8860B50',lty=3,lwd=4)
lines(x,(10^ylarge_m_10 + m_int_25203), col='#B8860B50',lty=3,lwd=4)
lines(x,(10^ymedium_m_10 + m_int_28141), col='#6495ED50',lty=3,lwd=4)
lines(x,(10^ymedium_m_10 + m_int_28247), col='#6495ED50',lty=3,lwd=4)
lines(x,(10^ysmall_m_10 + m_int_25180), col='#B2ABD250',lty=3,lwd=4)
lines(x,(10^ysmall_m_10 + m_int_25182), col='#B2ABD250',lty=3,lwd=4)
# Add a legend
legend("top", legend=c("Hypoxia (10 kPa)"), cex=1.4,bty="n")
legend("bottomleft", legend=c("large", "medium","small"),
lty = c(1,1,1),lwd=3,bty="n",cex=1.2,
col=c('#B8860B', '#6495ED','#B2ABD2'))
legend("topleft", legend=c("(a)"), cex=1.4,bty="n")
#-------------------------------------------------------------------------------
par(mai=c(0.85,0.82,0,0))
plot(10^visregRes ~temperature,data=plot_b$res,
pch=16,cex=1.5,col=c('#B8860B70','#6495ED70','#B2ABD270')[as.factor(cell_area_cat)],
xlab="temperature (°C)",
ylab="fresh mass (mg)",
ylim=c(0.4,1.2),
las = 1,
xaxt="n",
cex.axis=1.2,cex.lab=1.4)
#update axis
axis(1,at=c(17,25), labels=c("17","25"),cex.axis=1.2)
#Add lines per cell size category
lines(x,(10^ylarge_m_21),col="#B8860B",lwd=4)
lines(x,(10^ymedium_m_21),col="#6495ED",lwd=4)
lines(x,(10^ysmall_m_21),col="#B2ABD2",lwd=4)
#Add lines per stock
lines(x,(10^ylarge_m_21 + m_int_28196), col='#B8860B50',lty=3,lwd=4)
lines(x,(10^ylarge_m_21 + m_int_25203), col='#B8860B50',lty=3,lwd=4)
lines(x,(10^ymedium_m_21 + m_int_28141), col='#6495ED50',lty=3,lwd=4)
lines(x,(10^ymedium_m_21 + m_int_28247), col='#6495ED50',lty=3,lwd=4)
lines(x,(10^ysmall_m_21 + m_int_25180), col='#B2ABD250',lty=3,lwd=4)
lines(x,(10^ysmall_m_21 + m_int_25182), col='#B2ABD250',lty=3,lwd=4)
# Add a legend
legend("top", legend=c("Normoxia (21 kPa)"), cex=1.4,bty="n")
legend("bottomleft", legend=c("large", "medium","small"),
lty = c(1,1,1),lwd=3,bty="n",cex=1.2,
col=c('#B8860B', '#6495ED','#B2ABD2'))
legend("topleft", legend=c("(b)"), cex=1.4,bty="n")
#-------------------------------------------------------------------------------
# labels
labs= c("5","7.5","10","12.5","15")
xs= c(500000,750000,1000000,1250000,1500000)
par(mai=c(0.85,0.82,0,0))
plot(10^visregRes ~temperature,data=plot_c$res,
pch=16,cex=1.5,col=c('#B8860B70','#6495ED70','#B2ABD270')[as.factor(cell_area_cat)],
xlab="temperature (°C)",
ylab=expression(paste("wing area (",mu, m^2,"× 100,000)")),
ylim=c(500000,1500000),
las = 1,
xaxt="n",
yaxt="n",
cex.axis=1.2,cex.lab=1.4)
#update axis
axis(1,at=c(17,25), labels=c("17","25"),cex.axis=1.2)
axis(2, at=xs, labels=labs, cex.axis=1.2,las=1)
#Add lines per cell size category
lines(x,(10^ylarge_w_10),col="#B8860B",lwd=4)
lines(x,(10^ymedium_w_10),col="#6495ED",lwd=4)
lines(x,(10^ysmall_w_10),col="#B2ABD2",lwd=4)
#Add lines per stock
lines(x,(10^ylarge_w_10 + w_int_28196), col='#B8860B50',lty=3,lwd=4)
lines(x,(10^ylarge_w_10 + w_int_25203), col='#B8860B50',lty=3,lwd=4)
lines(x,(10^ymedium_w_10 + w_int_28141), col='#6495ED50',lty=3,lwd=4)
lines(x,(10^ymedium_w_10 + w_int_28247), col='#6495ED50',lty=3,lwd=4)
lines(x,(10^ysmall_w_10 + w_int_25180), col='#B2ABD250',lty=3,lwd=4)
lines(x,(10^ysmall_w_10 + w_int_25182), col='#B2ABD250',lty=3,lwd=4)
# Add a legend
legend("top", legend=c("Hypoxia (10 kPa)"), cex=1.4,bty="n")
legend("bottomleft", legend=c("large", "medium","small"),
lty = c(1,1,1),lwd=3,bty="n",cex=1.2,
col=c('#B8860B', '#6495ED','#B2ABD2'))
legend("topleft", legend=c("(c)"), cex=1.4,bty="n")
#-------------------------------------------------------------------------------
labs= c("5","7.5","10","12.5","15")
xs= c(500000,750000,1000000,1250000,1500000)
par(mai=c(0.85,0.85,0,0))
plot(10^visregRes ~temperature,data=plot_d$res,
pch=16,cex=1.5,col=c('#B8860B70','#6495ED70','#B2ABD270')[as.factor(cell_area_cat)],
xlab="temperature (°C)",
ylab=expression(paste("wing area (",mu, m^2,"× 100,000)")),
ylim=c(500000,1500000),
las = 1,
xaxt="n",
yaxt="n",
cex.axis=1.2,cex.lab=1.4)
#update axis
axis(1,at=c(17,25), labels=c("17","25"),cex.axis=1.2)
axis(2, at=xs, labels=labs, cex.axis=1.2,las=1)
#Add lines per cell size category
lines(x,(10^ylarge_w_21),col="#B8860B",lwd=4)
lines(x,(10^ymedium_w_21),col="#6495ED",lwd=4)
lines(x,(10^ysmall_w_21),col="#B2ABD2",lwd=4)
#Add lines per stock
lines(x,(10^ylarge_w_21 + w_int_28196), col='#B8860B50',lty=3,lwd=4)
lines(x,(10^ylarge_w_21 + w_int_25203), col='#B8860B50',lty=3,lwd=4)
lines(x,(10^ymedium_w_21 + w_int_28141), col='#6495ED50',lty=3,lwd=4)
lines(x,(10^ymedium_w_21 + w_int_28247), col='#6495ED50',lty=3,lwd=4)
lines(x,(10^ysmall_w_21 + w_int_25180), col='#B2ABD250',lty=3,lwd=4)
lines(x,(10^ysmall_w_21 + w_int_25182), col='#B2ABD250',lty=3,lwd=4)
# Add a legend
legend("top", legend=c("Normoxia (21 kPa)"), cex=1.4,bty="n")
legend("bottomleft", legend=c("large", "medium","small"),
lty = c(1,1,1),lwd=3,bty="n",cex=1.2,
col=c('#B8860B', '#6495ED','#B2ABD2'))
legend("topleft", legend=c("(d)"), cex=1.4,bty="n")
#-------------------------------------------------------------------------------
par(mai=c(0.85,0.82,0,0))
plot(10^visregRes ~temperature,data=plot_e$res,
pch=16,cex=1.5,col=c('#B8860B70','#6495ED70','#B2ABD270')[as.factor(cell_area_cat)],
xlab="temperature (°C)",
ylab=expression(paste("cell area (",mu, m^2,")")),
xaxt="n",
ylim=c(80,220),
las=1,
xlim=c(14,28),
cex.axis=1.2,cex.lab=1.4)
#update axis
axis(1,at=c(17,25), labels=c("17","25"),cex.axis=1.2)
#Add lines per cell size category
lines(x,(10^ylarge_c_10),col="#B8860B",lwd=4)
lines(x,(10^ymedium_c_10),col="#6495ED",lwd=4)
lines(x,(10^ysmall_c_10),col="#B2ABD2",lwd=4)
#Add lines per stock
lines(x,(10^ylarge_c_10 + c_int_28196), col='#B8860B50',lty=3,lwd=4)
lines(x,(10^ylarge_c_10 + c_int_25203), col='#B8860B50',lty=3,lwd=4)
lines(x,(10^ymedium_c_10 + c_int_28141), col='#6495ED50',lty=3,lwd=4)
lines(x,(10^ymedium_c_10 + c_int_28247), col='#6495ED50',lty=3,lwd=4)
lines(x,(10^ysmall_c_10 + c_int_25180), col='#B2ABD250',lty=3,lwd=4)
lines(x,(10^ysmall_c_10 + c_int_25182), col='#B2ABD250',lty=3,lwd=4)
# Add a legend
legend("top", legend=c("Hypoxia (10 kPa)"), cex=1.4,bty="n")
legend("bottomleft", legend=c("large", "medium","small"),
lty = c(1,1,1),lwd=3,bty="n",cex=1.2,
col=c('#B8860B', '#6495ED','#B2ABD2'))
legend("topleft", legend=c("(e)"), cex=1.4,bty="n")
#-------------------------------------------------------------------------------
par(mai=c(0.85,0.82,0,0))
plot(10^visregRes ~temperature,data=plot_f$res,
pch=16,cex=1.5,col=c('#B8860B70','#6495ED70','#B2ABD270')[as.factor(cell_area_cat)],
xlab="temperature (°C)",
ylab=expression(paste("cell area (",mu, m^2,")")),
xaxt="n",
ylim=c(80,220),
las=1,
xlim=c(14,28),
cex.axis=1.2,cex.lab=1.4)
#update axis
axis(1,at=c(17,25), labels=c("17","25"),cex.axis=1.2)
#Add lines per cell size category
lines(x,(10^ylarge_c_21),col="#B8860B",lwd=4)
lines(x,(10^ymedium_c_21),col="#6495ED",lwd=4)
lines(x,(10^ysmall_c_21),col="#B2ABD2",lwd=4)
#Add lines per stock
lines(x,(10^ylarge_c_21 + c_int_28196), col='#B8860B50',lty=3,lwd=4)
lines(x,(10^ylarge_c_21 + c_int_25203), col='#B8860B50',lty=3,lwd=4)
lines(x,(10^ymedium_c_21 + c_int_28141), col='#6495ED50',lty=3,lwd=4)
lines(x,(10^ymedium_c_21 + c_int_28247), col='#6495ED50',lty=3,lwd=4)
lines(x,(10^ysmall_c_21 + c_int_25180), col='#B2ABD250',lty=3,lwd=4)
lines(x,(10^ysmall_c_21 + c_int_25182), col='#B2ABD250',lty=3,lwd=4)
# Add a legend
legend("top", legend=c("Normoxia (21 kPa)"), cex=1.4,bty="n")
legend("bottomleft", legend=c("large", "medium","small"),
lty = c(1,1,1),lwd=3,bty="n",cex=1.2,
col=c('#B8860B', '#6495ED','#B2ABD2'))
legend("topleft", legend=c("(f)"), cex=1.4,bty="n")
#-------------------------------------------------------------------------------
dev.off()
}
# ------------------------------------------------------------------------------
# saving session information with all packages versions for reproducibility purposes
sink("../Outputs/2.1.1. Data analyses_Table_1_and_Figure_2_R_session.txt")
sessionInfo()
sink()
# ------------------------------------------------------------------------------
################################################################################
############################ END OF SCRIPT #####################################
################################################################################
10^ylarge_m_21 + m_int_28196
10^ylarge_m_21 + m_int_25203
10^ylarge_m_21
plot(10^visregRes ~temperature,data=plot_c$res,
pch=16,cex=1.5,col=c('#B8860B70','#6495ED70','#B2ABD270')[as.factor(cell_area_cat)],
xlab="temperature (°C)",
ylab=expression(paste("wing area (",mu, m^2,"× 100,000)")),
ylim=c(500000,1500000),
las = 1,
xaxt="n",
yaxt="n",
cex.axis=1.2,cex.lab=1.4)
dev.off()
plot(10^visregRes ~temperature,data=plot_c$res,
pch=16,cex=1.5,col=c('#B8860B70','#6495ED70','#B2ABD270')[as.factor(cell_area_cat)],
xlab="temperature (°C)",
ylab=expression(paste("wing area (",mu, m^2,"× 100,000)")),
ylim=c(500000,1500000),
las = 1,
xaxt="n",
yaxt="n",
cex.axis=1.2,cex.lab=1.4)
#update axis
axis(1,at=c(17,25), labels=c("17","25"),cex.axis=1.2)
axis(2, at=xs, labels=labs, cex.axis=1.2,las=1)
ylarge_w_10
par(mai=c(0.85,0.82,0,0))
plot(10^visregRes ~temperature,data=plot_a$res,
pch=16,cex=1.5,col=c('#B8860B70','#6495ED70','#B2ABD270')[as.factor(cell_area_cat)],
xlab="temperature (°C)",
ylab="fresh mass (mg)",
ylim=c(0.4,1.2),
las = 1,
xaxt="n",
cex.axis=1.2,cex.lab=1.4)
#update axis
axis(1,at=c(17,25), labels=c("17","25"),cex.axis=1.2)
#Add lines per cell size category
lines(x,(10^ylarge_m_10),col="#B8860B",lwd=4)
lines(x,(10^ymedium_m_10),col="#6495ED",lwd=4)
lines(x,(10^ysmall_m_10),col="#B2ABD2",lwd=4)
#Add lines per stock
lines(x,(10^ylarge_m_10 + m_int_28196), col='#B8860B50',lty=3,lwd=4)
lines(x,(10^ylarge_m_10 + m_int_25203), col='#B8860B50',lty=3,lwd=4)
lines(x,(10^ymedium_m_10 + m_int_28141), col='#6495ED50',lty=3,lwd=4)
lines(x,(10^ymedium_m_10 + m_int_28247), col='#6495ED50',lty=3,lwd=4)
lines(x,(10^ysmall_m_10 + m_int_25180), col='#B2ABD250',lty=3,lwd=4)
lines(x,(10^ysmall_m_10 + m_int_25182), col='#B2ABD250',lty=3,lwd=4)
# Add a legend
legend("top", legend=c("Hypoxia (10 kPa)"), cex=1.4,bty="n")
legend("bottomleft", legend=c("large", "medium","small"),
lty = c(1,1,1),lwd=3,bty="n",cex=1.2,
col=c('#B8860B', '#6495ED','#B2ABD2'))
legend("topleft", legend=c("(a)"), cex=1.4,bty="n")
10^ylarge_w_10 + w_int_28196
x,(10^ylarge_w_10 + w_int_28196
x
x,(10^ylarge_w_10 + w_int_28196)
10^ylarge_w_10
10^ylarge_w_10 + w_int_28196
10^ylarge_w_10
w_int_28196
w_int_25203
w_int_28141
w_int_28247
w_int_25180
w_int_25182
plot(10^visregRes ~temperature,data=plot_c$res,
pch=16,cex=1.5,col=c('#B8860B70','#6495ED70','#B2ABD270')[as.factor(cell_area_cat)],
xlab="temperature (°C)",
ylab=expression(paste("wing area (",mu, m^2,"× 100,000)")),
ylim=c(500000,1500000),
las = 1,
xaxt="n",
yaxt="n",
cex.axis=1.2,cex.lab=1.4)
#update axis
axis(1,at=c(17,25), labels=c("17","25"),cex.axis=1.2)
axis(2, at=xs, labels=labs, cex.axis=1.2,las=1)
#Add lines per cell size category
lines(x,(10^ylarge_w_10),col="#B8860B",lwd=4)
lines(x,(10^ymedium_w_10),col="#6495ED",lwd=4)
lines(x,(10^ysmall_w_10),col="#B2ABD2",lwd=4)
#Add lines per stock
lines(x,(10^ylarge_w_10 + w_int_28196), col='red',lty=3,lwd=8)
lines(x,(10^ylarge_w_10 + w_int_25203), col='#B8860B50',lty=3,lwd=4)
lines(x,(10^ymedium_w_10 + w_int_28141), col='#6495ED50',lty=3,lwd=4)
lines(x,(10^ymedium_w_10 + w_int_28247), col='#6495ED50',lty=3,lwd=4)
lines(x,(10^ysmall_w_10 + w_int_25180), col='#B2ABD250',lty=3,lwd=4)
lines(x,(10^ysmall_w_10 + w_int_25182), col='#B2ABD250',lty=3,lwd=4)
par(mai=c(0.85,0.82,0,0))
plot(10^visregRes ~temperature,data=plot_c$res,
pch=16,cex=1.5,col=c('#B8860B70','#6495ED70','#B2ABD270')[as.factor(cell_area_cat)],
xlab="temperature (°C)",
ylab=expression(paste("wing area (",mu, m^2,"× 100,000)")),
ylim=c(500000,1500000),
las = 1,
xaxt="n",
yaxt="n",
cex.axis=1.2,cex.lab=1.4)
#update axis
axis(1,at=c(17,25), labels=c("17","25"),cex.axis=1.2)
axis(2, at=xs, labels=labs, cex.axis=1.2,las=1)
#Add lines per cell size category
#lines(x,(10^ylarge_w_10),col="#B8860B",lwd=4)
lines(x,(10^ymedium_w_10),col="#6495ED",lwd=4)
lines(x,(10^ysmall_w_10),col="#B2ABD2",lwd=4)
#Add lines per stock
lines(x,(10^ylarge_w_10 + w_int_28196), col='red',lty=3,lwd=8)
lines(x,(10^ylarge_w_10 + w_int_25203), col='#B8860B50',lty=3,lwd=4)
lines(x,(10^ymedium_w_10 + w_int_28141), col='#6495ED50',lty=3,lwd=4)
lines(x,(10^ymedium_w_10 + w_int_28247), col='#6495ED50',lty=3,lwd=4)
lines(x,(10^ysmall_w_10 + w_int_25180), col='#B2ABD250',lty=3,lwd=4)
lines(x,(10^ysmall_w_10 + w_int_25182), col='#B2ABD250',lty=3,lwd=4)
#-------------------------------------------------------------------------------
#Large celled-lines
w5_10<-lmer(wing_area_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock), data=dat)
ranef(w5_10)
