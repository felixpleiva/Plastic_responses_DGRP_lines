line=list(col=c('#B8860B', '#6495ED','#B2ABD2'),lwd=4),
xlab="Temperature (°C)",
ylab=expression(paste(log[10], "[cell area (",mu, m^2,")]")),
ylim=c(1.9,2.4),
xaxt="n",
xlim=c(14,28),
cex.axis=1.2,cex.lab=1.4)
axis(1,at=c(17,25),
labels=c("17","25"),cex.axis=1.2)
# Add a legend
legend("top", legend=c("Normoxia (21 kPa)"), cex=1.4,bty="n")
legend("bottomleft", legend=c("large", "medium","small"),
lty = c(1,1,1),lwd=3,bty="n",cex=1.2,
col=c('#B8860B', '#6495ED','#B2ABD2'))
legend("topleft", legend=c("(f)"), cex=1.4,bty="n")
dev.off()
}
################################################################################
{
pdf("2.2.1. Figure 2.pdf",width = 7,height = 10,useDingbats = FALSE)
#png("2.2.1. Figure 2.png",width = 7,height = 10,units = "in",res = 600)
par(mfrow=c(3,2),tcl=-0.4, family="serif",omi=c(0,0,0,0.1))
#-------------------------------------------------------------------------------
#Fresh mass
par(mai=c(0.85,0.82,0,0))
visreg(m5,'temperature', by='cell_area_cat',cond = list(oxygen=10),
print.cond=TRUE,overlay=TRUE,jitter=0.1,legend = FALSE,
points=list(col=c('#B8860B70', '#6495ED70','#B2ABD270'),cex=1.5,pch=16),
line=list(col=c('#B8860B', '#6495ED','#B2ABD2'),lwd=4),
xlab="Temperature (°C)",
ylab=expression(paste(log[10],"[fresh mass (mg)]")),
ylim=c(-0.4,0.1),
xaxt="n",
xlim=c(14,28),
cex.axis=1.2,cex.lab=1.4)
axis(1,at=c(17,25),
labels=c("17","25"),cex.axis=1.2)
# Add a legend
legend("top", legend=c("Hypoxia (10 kPa)"), cex=1.4,bty="n")
legend("bottomleft", legend=c("large", "medium","small"),
lty = c(1,1,1),lwd=3,bty="n",cex=1.2,
col=c('#B8860B', '#6495ED','#B2ABD2'))
legend("topleft", legend=c("(a)"), cex=1.4,bty="n")
par(mai=c(0.85,0.82,0,0))
visreg(m5,'temperature', by='cell_area_cat',cond = list(oxygen=21),
print.cond=TRUE,overlay=TRUE,jitter=0.1,legend = FALSE,
points=list(col=c('#B8860B70', '#6495ED70','#B2ABD270'),cex=1.5,pch=16),
line=list(col=c('#B8860B', '#6495ED','#B2ABD2'),lwd=4),
xlab="Temperature (°C)",
ylab=expression(paste(log[10],"[fresh mass (mg)]")),
ylim=c(-0.4,0.1),
xaxt="n",
xlim=c(14,28),
cex.axis=1.2,cex.lab=1.4)
axis(1,at=c(17,25),
labels=c("17","25"),cex.axis=1.2)
# Add a legend
legend("top", legend=c("Normoxia (21 kPa)"), cex=1.4,bty="n")
legend("bottomleft", legend=c("large", "medium","small"),
lty = c(1,1,1),lwd=3,bty="n",cex=1.2,
col=c('#B8860B', '#6495ED','#B2ABD2'))
legend("topleft", legend=c("(b)"), cex=1.4,bty="n")
#-------------------------------------------------------------------------------
#Wing area
par(mai=c(0.85,0.82,0,0))
visreg(w5,'temperature', by='cell_area_cat',cond = list(oxygen=10),
print.cond=TRUE,overlay=TRUE,jitter=0.1,legend = FALSE,
points=list(col=c('#B8860B70', '#6495ED70','#B2ABD270'),cex=1.5,pch=16),
line=list(col=c('#B8860B', '#6495ED','#B2ABD2'),lwd=4),
xlab="Temperature (°C)",
ylab=expression(paste(log[10], "[wing area (",mu, m^2,")]")),
ylim=c(5.7,6.2),
xaxt="n",
xlim=c(14,28),
cex.axis=1.2,cex.lab=1.4)
axis(1,at=c(17,25),
labels=c("17","25"),cex.axis=1.2)
# Add a legend
legend("top", legend=c("Hypoxia (10 kPa)"), cex=1.4,bty="n")
legend("bottomleft", legend=c("large", "medium","small"),
lty = c(1,1,1),lwd=3,bty="n",cex=1.2,
col=c('#B8860B', '#6495ED','#B2ABD2'))
legend("topleft", legend=c("(c)"), cex=1.4,bty="n")
par(mai=c(0.85,0.85,0,0))
visreg(w5,'temperature', by='cell_area_cat',cond = list(oxygen=21),
print.cond=TRUE,overlay=TRUE,jitter=0.1,legend = FALSE,
points=list(col=c('#B8860B70', '#6495ED70','#B2ABD270'),cex=1.5,pch=16),
line=list(col=c('#B8860B', '#6495ED','#B2ABD2'),lwd=4),
xlab="Temperature (°C)",
ylab=expression(paste(log[10], "[wing area (",mu, m^2,")]")),
ylim=c(5.7,6.2),
xaxt="n",
xlim=c(14,28),
cex.axis=1.2,cex.lab=1.4)
axis(1,at=c(17,25),
labels=c("17","25"),cex.axis=1.2)
# Add a legend
legend("top", legend=c("Normoxia (21 kPa)"), cex=1.4,bty="n")
legend("bottomleft", legend=c("large", "medium","small"),
lty = c(1,1,1),lwd=3,bty="n",cex=1.2,
col=c('#B8860B', '#6495ED','#B2ABD2'))
legend("topleft", legend=c("(d)"), cex=1.4,bty="n")
#-------------------------------------------------------------------------------
#Cell area
par(mai=c(0.85,0.82,0,0))
visreg(c5,'temperature', by='cell_area_cat',cond = list(oxygen=10),
print.cond=TRUE,overlay=TRUE,jitter=0.1,legend = FALSE,
points=list(col=c('#B8860B70', '#6495ED70','#B2ABD270'),cex=1.5,pch=16),
line=list(col=c('#B8860B', '#6495ED','#B2ABD2'),lwd=4),
xlab="Temperature (°C)",
ylab=expression(paste(log[10], "[cell area (",mu, m^2,")]")),
ylim=c(1.9,2.4),
xaxt="n",
xlim=c(14,28),
cex.axis=1.2,cex.lab=1.4)
axis(1,at=c(17,25),
labels=c("17","25"),cex.axis=1.2)
# Add a legend
legend("top", legend=c("Hypoxia (10 kPa)"), cex=1.4,bty="n")
legend("bottomleft", legend=c("large", "medium","small"),
lty = c(1,1,1),lwd=3,bty="n",cex=1.2,
col=c('#B8860B', '#6495ED','#B2ABD2'))
legend("topleft", legend=c("(e)"), cex=1.4,bty="n")
par(mai=c(0.85,0.82,0,0))
visreg(c5,'temperature', by='cell_area_cat',cond = list(oxygen=21),
print.cond=TRUE,overlay=TRUE,jitter=0.1,legend = FALSE,
points=list(col=c('#B8860B70', '#6495ED70','#B2ABD270'),cex=1.5,pch=16),
line=list(col=c('#B8860B', '#6495ED','#B2ABD2'),lwd=4),
xlab="Temperature (°C)",
ylab=expression(paste(log[10], "[cell area (",mu, m^2,")]")),
ylim=c(1.9,2.4),
xaxt="n",
xlim=c(14,28),
cex.axis=1.2,cex.lab=1.4)
axis(1,at=c(17,25),
labels=c("17","25"),cex.axis=1.2)
# Add a legend
legend("top", legend=c("Normoxia (21 kPa)"), cex=1.4,bty="n")
legend("bottomleft", legend=c("large", "medium","small"),
lty = c(1,1,1),lwd=3,bty="n",cex=1.2,
col=c('#B8860B', '#6495ED','#B2ABD2'))
legend("topleft", legend=c("(f)"), cex=1.4,bty="n")
dev.off()
}
coef(m5)
summary(m5)
Anova(m5,test.statistic="F")
#-------------------------------------------------------------------------------
# Summary Tables of the best models
#-------------------------------------------------------------------------------
# fresh mass
m5<-lmer(fresh_mass_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock), data=dat)
Anova(m5,test.statistic="F")
summary(m5)
library(lattive)
library(lattice)
dotplot(ranef(m5,condVar=TRUE))
m5.d<-lmer(fresh_mass_log ~ temperature * oxygen * cell_area_cat +  sex + (cell_area_cat|stock),data=dat)
m5.d<-lmer(fresh_mass_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock) + (1|temperature:oxygen),data=dat)
m5.e<-lmer(fresh_mass_log ~ temperature * oxygen * cell_area_cat +  sex + (cell_area_cat|stock),data=dat)
# we see several models DO NOT converges, but two of them does (model m5.c and m5.e).
anova(m5c,m5.d)
m5.c<-lmer(fresh_mass_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock) + (1|temperature) + (1|oxygen), data=dat)
m5.d<-lmer(fresh_mass_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock) + (1|temperature:oxygen),data=dat)
m5.e<-lmer(fresh_mass_log ~ temperature * oxygen * cell_area_cat +  sex + (cell_area_cat|stock),data=dat)
m5.c<-lmer(fresh_mass_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock) + (1|temperature) + (1|oxygen), data=dat)
m5.d<-lmer(fresh_mass_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock) + (1|temperature:oxygen),data=dat)
#-------------------------------------------------------------------------------
# Test more complex structures on the most informative model
#-------------------------------------------------------------------------------
# fresh mass
m5<-lmer(fresh_mass_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock), data=dat)
m5.a<-lmer(fresh_mass_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock) + (1|temperature), data=dat)
m5.b<-lmer(fresh_mass_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock) + (1|oxygen),data=dat)
m5.c<-lmer(fresh_mass_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock) + (1|temperature) + (1|oxygen), data=dat)
m5.d<-lmer(fresh_mass_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock) + (1|temperature:oxygen),data=dat)
m5.e<-lmer(fresh_mass_log ~ temperature * oxygen * cell_area_cat +  sex + (cell_area_cat|stock),data=dat)
# we see several models DO NOT converges, but two of them does (model m5.c and m5.e).
anova(m5c,m5.d)
# we see several models DO NOT converges, but two of them does (model m5.c and m5.e).
anova(m5.c,m5.d)
m5.c<-lmer(fresh_mass_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock) + (1|temperature) + (1|oxygen), data=dat)
m5.d<-lmer(fresh_mass_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock) + (1|temperature:oxygen),data=dat)
# we see several models DO NOT converges, but two of them does (model m5.c and m5.e).
anova(m5.c,m5.e)
anova(m5,m5.c)
m5<-lmer(fresh_mass_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock), data=dat)
Anova(m5,test.statistic="F")
summary(m5)
coef(m5)
dotplot(ranef(m5,condVar=TRUE))
coef(w5)
dotplot(ranef(w5,condVar=TRUE))
# cell area
c5<-lmer(cell_area_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock), data=dat)
Anova(c5,test.statistic="F")
summary(c5)
coef(c5)
# wing area
w5<-lmer(wing_area_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock), data=dat)
w5.a<-lmer(wing_area_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock) + (1|temperature), data=dat)
w5.b<-lmer(wing_area_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock) + (1|oxygen), data=dat)
w5.c<-lmer(wing_area_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock) + (1|temperature) + (1|oxygen), data=dat)
w5.d<-lmer(wing_area_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock) + (1|temperature:oxygen), data=dat)
w5.e<-lmer(wing_area_log ~ temperature * oxygen * cell_area_cat +  sex + (cell_area_cat|stock),data=dat)
w5.e<-lmer(wing_area_log ~ temperature * oxygen * cell_area_cat +  sex + (cell_area_cat|stock),data=dat)
# wing area
w5<-lmer(wing_area_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock), data=dat)
w5.a<-lmer(wing_area_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock) + (1|temperature), data=dat)
w5.b<-lmer(wing_area_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock) + (1|oxygen), data=dat)
w5.c<-lmer(wing_area_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock) + (1|temperature) + (1|oxygen), data=dat)
# wing area
w5<-lmer(wing_area_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock), data=dat)
w5.a<-lmer(wing_area_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock) + (1|temperature), data=dat)
w5.b<-lmer(wing_area_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock) + (1|oxygen), data=dat)
w5.c<-lmer(wing_area_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock) + (1|temperature) + (1|oxygen), data=dat)
w5.d<-lmer(wing_area_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock) + (1|temperature:oxygen), data=dat)
w5.e<-lmer(wing_area_log ~ temperature * oxygen * cell_area_cat +  sex + (cell_area_cat|stock),data=dat)
# we see several models DO NOT converges, but one of them does (model w5.c).
anova(w5,w5.c)
# wing area
w5<-lmer(wing_area_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock), data=dat)
w5.a<-lmer(wing_area_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock) + (1|temperature), data=dat)
# wing area
w5<-lmer(wing_area_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock), data=dat)
w5.a<-lmer(wing_area_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock) + (1|temperature), data=dat)
w5.b<-lmer(wing_area_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock) + (1|oxygen), data=dat)
w5.c<-lmer(wing_area_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock) + (1|temperature) + (1|oxygen), data=dat)
w5.d<-lmer(wing_area_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock) + (1|temperature:oxygen), data=dat)
w5.e<-lmer(wing_area_log ~ temperature * oxygen * cell_area_cat +  sex + (cell_area_cat|stock),data=dat)
# we see several models DO NOT converges, but one of them does (model w5.c).
anova(w5,w5.c)
# cell area
c5<-lmer(cell_area_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock), data=dat)
c5.a<-lmer(cell_area_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock) + (1|temperature), data=dat)
c5.b<-lmer(cell_area_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock) + (1|oxygen), data=dat)
c5.c<-lmer(cell_area_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock) + (1|temperature) + (1|oxygen), data=dat)
c5.d<-lmer(cell_area_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock) + (1|temperature:oxygen), data=dat)
c5.e<-lmer(cell_area_log ~ temperature * oxygen * cell_area_cat +  sex + (cell_area_cat|stock),data=dat)
# cell area
c5<-lmer(cell_area_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock), data=dat)
c5.a<-lmer(cell_area_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock) + (1|temperature), data=dat)
c5.b<-lmer(cell_area_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock) + (1|oxygen), data=dat)
c5.c<-lmer(cell_area_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock) + (1|temperature) + (1|oxygen), data=dat)
c5.d<-lmer(cell_area_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock) + (1|temperature:oxygen), data=dat)
c5.e<-lmer(cell_area_log ~ temperature * oxygen * cell_area_cat +  sex + (cell_area_cat|stock),data=dat)
# cell area
c5<-lmer(cell_area_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock), data=dat)
c5.a<-lmer(cell_area_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock) + (1|temperature), data=dat)
c5.b<-lmer(cell_area_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock) + (1|oxygen), data=dat)
c5.c<-lmer(cell_area_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock) + (1|temperature) + (1|oxygen), data=dat)
c5.d<-lmer(cell_area_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock) + (1|temperature:oxygen), data=dat)
c5.e<-lmer(cell_area_log ~ temperature * oxygen * cell_area_cat +  sex + (cell_area_cat|stock),data=dat)
c5.c<-lmer(cell_area_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock) + (1|temperature) + (1|oxygen), data=dat)
c5.c<-lmer(cell_area_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock) + (1|temperature) + (1|oxygen), data=dat)
summary(c5.c)
# cell area
c5<-lmer(cell_area_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock), data=dat)
c5.a<-lmer(cell_area_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock) + (1|temperature), data=dat)
c5.b<-lmer(cell_area_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock) + (1|oxygen), data=dat)
c5.c<-lmer(cell_area_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock) + (1|temperature) + (1|oxygen), data=dat)
c5.d<-lmer(cell_area_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock) + (1|temperature:oxygen), data=dat)
c5.e<-lmer(cell_area_log ~ temperature * oxygen * cell_area_cat +  sex + (cell_area_cat|stock),data=dat)
# cell area
c5<-lmer(cell_area_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock), data=dat)
c5.a<-lmer(cell_area_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock) + (1|temperature), data=dat)
c5.b<-lmer(cell_area_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock) + (1|oxygen), data=dat)
c5.c<-lmer(cell_area_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock) + (1|temperature) + (1|oxygen), data=dat)
c5.d<-lmer(cell_area_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock) + (1|temperature:oxygen), data=dat)
c5.e<-lmer(cell_area_log ~ temperature * oxygen * cell_area_cat +  sex + (cell_area_cat|stock),data=dat)
# One model DO NOT converges (model c5.e), the rest does.
anova(c5,c5.a)
anova(c5,c5.b)
anova(c5,c5.c)
# One model DO NOT converges (model c5.e), the rest does.
anova(c5,c5.a)
anova(c5,c5.b)
anova(c5,c5.c)
anova(c5,c5.d)
# more complex random structures does not help to explain the variation in cell area
#-------------------------------------------------------------------------------
# Summary Tables of the best models
#-------------------------------------------------------------------------------
# fresh mass
m5<-lmer(fresh_mass_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock), data=dat)
Anova(m5,test.statistic="F")
summary(m5)
?visreg.faq
a<-
visreg(m5,'temperature', by='cell_area_cat',cond = list(oxygen=10),
print.cond=TRUE,overlay=TRUE,jitter=0.1,legend = FALSE,
points=list(col=c('#B8860B70', '#6495ED70','#B2ABD270'),cex=1.5,pch=16),
line=list(col=c('#B8860B', '#6495ED','#B2ABD2'),lwd=4),
xlab="Temperature (°C)",
ylab=expression(paste(log[10],"[fresh mass (mg)]")),
ylim=c(-0.4,0.1),
xaxt="n",
xlim=c(14,28),
cex.axis=1.2,cex.lab=1.4)
a<-
visreg(m5,'temperature', by='cell_area_cat',cond = list(oxygen=10),plot=FALSE,
print.cond=TRUE,overlay=TRUE,jitter=0.1,legend = FALSE,
points=list(col=c('#B8860B70', '#6495ED70','#B2ABD270'),cex=1.5,pch=16),
line=list(col=c('#B8860B', '#6495ED','#B2ABD2'),lwd=4),
xlab="Temperature (°C)",
ylab=expression(paste(log[10],"[fresh mass (mg)]")),
ylim=c(-0.4,0.1),
xaxt="n",
xlim=c(14,28),
cex.axis=1.2,cex.lab=1.4)
a<-
visreg(m5,'temperature', by='cell_area_cat',cond = list(oxygen=10),plot=FALSE,
print.cond=TRUE,overlay=TRUE,jitter=0.1,legend = FALSE,
points=list(col=c('#B8860B70', '#6495ED70','#B2ABD270'),cex=1.5,pch=16),
line=list(col=c('#B8860B', '#6495ED','#B2ABD2'),lwd=4),
xlab="Temperature (°C)",
ylab=expression(paste(log[10],"[fresh mass (mg)]")),
ylim=c(-0.4,0.1),
xaxt="n",
xlim=c(14,28),
cex.axis=1.2,cex.lab=1.4)
axis(1,at=c(17,25),
labels=c("17","25"),cex.axis=1.2)
# Add a legend
legend("top", legend=c("Hypoxia (10 kPa)"), cex=1.4,bty="n")
legend("bottomleft", legend=c("large", "medium","small"),
lty = c(1,1,1),lwd=3,bty="n",cex=1.2,
col=c('#B8860B', '#6495ED','#B2ABD2'))
legend("topleft", legend=c("(a)"), cex=1.4,bty="n")
plot(a)
plot(v, overlay=TRUE)
plot(a, overlay=TRUE)
coef(m5)
x11()
coef(m5)
coef_m<-coef(m5)
coef_m$stock
coef_m$stock[2]
coef_m$stock[1:3,2]
coef_m$stock[3,5]
coef_m$stock[,5]
coef_m$stock[2,]
coef_m<-coef(m5)
coef_m
abline(coef_m$stock)
abline(coef_m$stock[1])
abline(0.2974078,-0.01289562)#25180 (Small)
par(mfrow=c(3,2),tcl=-0.4, family="serif",omi=c(0,0,0,0.1))
#-------------------------------------------------------------------------------
#Fresh mass
par(mai=c(0.85,0.82,0,0))
visreg(m5,'temperature', by='cell_area_cat',cond = list(oxygen=10),
print.cond=TRUE,overlay=TRUE,jitter=0.1,legend = FALSE,
points=list(col=c('#B8860B70', '#6495ED70','#B2ABD270'),cex=1.5,pch=16),
line=list(col=c('#B8860B', '#6495ED','#B2ABD2'),lwd=4),
xlab="Temperature (°C)",
ylab=expression(paste(log[10],"[fresh mass (mg)]")),
ylim=c(-0.4,0.1),
xaxt="n",
xlim=c(14,28),
cex.axis=1.2,cex.lab=1.4)
axis(1,at=c(17,25),
labels=c("17","25"),cex.axis=1.2)
abline(0.2974078,-0.01289562)#25180 (Small)
abline(0.3258270,-0.01289562)#25182 (Small)
abline(0.2921045,-0.01289562)#28141 (Medium)
abline(0.2921045,-0.01289562)#28247 (Medium)
abline(0.3328213,-0.01289562)#28196 (Large)
abline(0.3311303,-0.01289562)#25203 (LArge)
# Add a legend
legend("top", legend=c("Hypoxia (10 kPa)"), cex=1.4,bty="n")
legend("bottomleft", legend=c("large", "medium","small"),
lty = c(1,1,1),lwd=3,bty="n",cex=1.2,
col=c('#B8860B', '#6495ED','#B2ABD2'))
legend("topleft", legend=c("(a)"), cex=1.4,bty="n")
summary(m5)
#Fresh mass
par(mai=c(0.85,0.82,0,0))
visreg(m5,'temperature', by='cell_area_cat',cond = list(oxygen=10),
print.cond=TRUE,overlay=TRUE,jitter=0.1,legend = FALSE,
points=list(col=c('#B8860B70', '#6495ED70','#B2ABD270'),cex=1.5,pch=16),
line=list(col=c('#B8860B', '#6495ED','#B2ABD2'),lwd=4),
xlab="Temperature (°C)",
ylab=expression(paste(log[10],"[fresh mass (mg)]")),
ylim=c(-0.4,0.1),
xaxt="n",
xlim=c(14,28),
cex.axis=1.2,cex.lab=1.4)
axis(1,at=c(17,25),
labels=c("17","25"),cex.axis=1.2)
abline(0.2974078,0.0004029)#25180 (Small)
abline(0.3258270,-0.01289562)#25182 (Small)
abline(0.2921045,-0.01289562)#28141 (Medium)
abline(0.2921045,-0.01289562)#28247 (Medium)
abline(0.3328213,-0.01289562)#28196 (Large)
abline(0.3311303,-0.01289562)#25203 (LArge)
abline(-0.01289562,0.3258270)#25182 (Small)
abline(0.0004029,0.2974078)#25180 (Small)
abline(-0.01289562,0.3258270)#25182 (Small)
abline(-0.01289562,0.2921045)#28141 (Medium)
abline(-0.01289562,0.2921045)#28247 (Medium)
abline(-0.01289562,0.3328213)#28196 (Large)
abline(-0.01289562,0.3311303)#25203 (LArge)
visreg(m5,'temperature', by='cell_area_cat',cond = list(oxygen=10),
print.cond=TRUE,overlay=TRUE,jitter=0.1,legend = FALSE,
points=list(col=c('#B8860B70', '#6495ED70','#B2ABD270'),cex=1.5,pch=16),
line=list(col=c('#B8860B', '#6495ED','#B2ABD2'),lwd=4),
xlab="Temperature (°C)",
ylab=expression(paste(log[10],"[fresh mass (mg)]")),
ylim=c(-0.4,0.1),
xaxt="n",
xlim=c(14,28),
cex.axis=1.2,cex.lab=1.4)
axis(1,at=c(17,25),
labels=c("17","25"),cex.axis=1.2)
abline(0.0004029,0.2974078)#25180 (Small)
abline(-0.01289562,0.3258270)#25182 (Small)
abline(-0.01289562,0.2921045)#28141 (Medium)
abline(-0.01289562,0.2921045)#28247 (Medium)
abline(-0.01289562,0.3328213)#28196 (Large)
abline(-0.01289562,0.3311303)#25203 (LArge)
abline(0.0004029)#25180 (Small)
abline(0.2974078)#25180 (Small)
par(mai=c(0.85,0.82,0,0))
visreg(m5,'temperature', by='cell_area_cat',cond = list(oxygen=10),
print.cond=TRUE,overlay=TRUE,jitter=0.1,legend = FALSE,
points=list(col=c('#B8860B70', '#6495ED70','#B2ABD270'),cex=1.5,pch=16),
line=list(col=c('#B8860B', '#6495ED','#B2ABD2'),lwd=4),
xlab="Temperature (°C)",
ylab=expression(paste(log[10],"[fresh mass (mg)]")),
ylim=c(-0.4,0.1),
xaxt="n",
xlim=c(14,28),
cex.axis=1.2,cex.lab=1.4)
axis(1,at=c(17,25),
labels=c("17","25"),cex.axis=1.2)
abline(0.2974078)#25180 (Small)
abline(0.3258270,-0.01289562)#25182 (Small)
abline(0.2921045,-0.01289562)#28141 (Medium)
abline(0.2921045,-0.01289562)#28247 (Medium)
abline(0.3328213,-0.01289562)#28196 (Large)
abline(0.3311303,-0.01289562)#25203 (LArge)
m5.f<-lmer(fresh_mass_log ~ temperature * oxygen * cell_area_cat +  sex + + (1|stock)+ (1+ cell_area_cat|stock),data=dat)
m5.f<-lmer(fresh_mass_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock)+ (1+ cell_area_cat|stock),data=dat)
m5.f<-lmer(fresh_mass_log ~ temperature * oxygen * cell_area_cat +  sex + (1+ cell_area_cat|stock),data=dat)
#-------------------------------------------------------------------------------
# Test more complex structures on the most informative model
#-------------------------------------------------------------------------------
# fresh mass
m5<-lmer(fresh_mass_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock), data=dat)
m5.a<-lmer(fresh_mass_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock) + (1|temperature), data=dat)
m5.b<-lmer(fresh_mass_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock) + (1|oxygen),data=dat)
m5.c<-lmer(fresh_mass_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock) + (1|temperature) + (1|oxygen), data=dat)
m5.d<-lmer(fresh_mass_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock) + (1|temperature:oxygen),data=dat)
m5.e<-lmer(fresh_mass_log ~ temperature * oxygen * cell_area_cat +  sex + (cell_area_cat|stock),data=dat)
m5.f<-lmer(fresh_mass_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock) + (cell_area_cat|stock),data=dat)
m5.g<-lmer(fresh_mass_log ~ temperature * oxygen * cell_area_cat +  sex + (1+ cell_area_cat|stock),data=dat)
#-------------------------------------------------------------------------------
# Test more complex structures on the most informative model
#-------------------------------------------------------------------------------
# fresh mass
m5<-lmer(fresh_mass_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock), data=dat)
m5.a<-lmer(fresh_mass_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock) + (1|temperature), data=dat)
#-------------------------------------------------------------------------------
# Test more complex structures on the most informative model
#-------------------------------------------------------------------------------
# fresh mass
m5<-lmer(fresh_mass_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock), data=dat)
m5.a<-lmer(fresh_mass_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock) + (1|temperature), data=dat)
m5.b<-lmer(fresh_mass_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock) + (1|oxygen),data=dat)
m5.c<-lmer(fresh_mass_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock) + (1|temperature) + (1|oxygen), data=dat)
m5.d<-lmer(fresh_mass_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock) + (1|temperature:oxygen),data=dat)
m5.e<-lmer(fresh_mass_log ~ temperature * oxygen * cell_area_cat +  sex + (cell_area_cat|stock),data=dat)
m5.f<-lmer(fresh_mass_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock) + (cell_area_cat|stock),data=dat)
m5.g<-lmer(fresh_mass_log ~ temperature * oxygen * cell_area_cat +  sex + (1+ cell_area_cat|stock),data=dat)
# we see several models DO NOT converges, but two of them does (model m5.c and m5.e and m5.g).
anova(m5.c,m5.e)
anova(m5.c,m5.g)
m5.f<-lmer(fresh_mass_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock) + (cell_area_cat|stock),data=dat)
m5.g<-lmer(fresh_mass_log ~ temperature * oxygen * cell_area_cat +  sex + (1+ cell_area_cat|stock),data=dat)
# we see several models DO NOT converges, but two of them does (model m5.c and m5.e and m5.g).
anova(m5.c,m5.e)
anova(m5.c,m5.g)
anova(m5,m5.c)
# wing area
w5<-lmer(wing_area_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock), data=dat)
w5.a<-lmer(wing_area_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock) + (1|temperature), data=dat)
w5.b<-lmer(wing_area_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock) + (1|oxygen), data=dat)
w5.c<-lmer(wing_area_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock) + (1|temperature) + (1|oxygen), data=dat)
w5.d<-lmer(wing_area_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock) + (1|temperature:oxygen), data=dat)
w5.e<-lmer(wing_area_log ~ temperature * oxygen * cell_area_cat +  sex + (cell_area_cat|stock),data=dat)
w5.f<-lmer(wing_area_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock) + (cell_area_cat|stock),data=dat)
w5.g<-lmer(wing_area_log ~ temperature * oxygen * cell_area_cat +  sex + (1+ cell_area_cat|stock),data=dat)
# we see several models DO NOT converges, but one of them does (model w5.c and w5.f).
anova(w5.c,w5.f)
anova(w5,w5.c)
anova(w5,w5.f)
w5.f<-lmer(cell_area_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock) + (cell_area_cat|stock),data=dat)
w5.g<-lmer(cell_area_log ~ temperature * oxygen * cell_area_cat +  sex + (1+ cell_area_cat|stock),data=dat)
# cell area
c5<-lmer(cell_area_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock), data=dat)
c5.a<-lmer(cell_area_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock) + (1|temperature), data=dat)
c5.b<-lmer(cell_area_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock) + (1|oxygen), data=dat)
c5.c<-lmer(cell_area_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock) + (1|temperature) + (1|oxygen), data=dat)
c5.d<-lmer(cell_area_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock) + (1|temperature:oxygen), data=dat)
c5.e<-lmer(cell_area_log ~ temperature * oxygen * cell_area_cat +  sex + (cell_area_cat|stock),data=dat)
c5.f<-lmer(cell_area_log ~ temperature * oxygen * cell_area_cat +  sex + (1|stock) + (cell_area_cat|stock),data=dat)
c5.g<-lmer(cell_area_log ~ temperature * oxygen * cell_area_cat +  sex + (1+ cell_area_cat|stock),data=dat)
c5.g<-lmer(cell_area_log ~ temperature * oxygen * cell_area_cat +  sex + (1+ cell_area_cat|stock),data=dat)
anova(c5,c5.f)
anova(m5)
summary(m5)
