dat$well<-as.factor(dat$well)
dat$stock<-as.factor(dat$stock)
dat$sex<-as.factor(dat$sex)
dat$left_or_rigth<-as.factor(dat$left_or_rigth)
dat$temperature<-as.numeric(dat$temperature)
dat$oxygen<-as.numeric(dat$oxygen)
dat$age<-as.numeric(dat$age)
dat$left_or_rigth<-as.factor(dat$left_or_rigth)
#------------------------------------------------------------------------------
#create a new column to identify individual flies with the identical ID as for the
#wing photos
dat$ID_fly<-as.factor(paste(dat$plate,dat$well,sep = "-"))
View(dat)
# ------------------------------------------------------------------------------
# Data generated by Félix P Leiva, Radboud University (e-mail: felixpleiva@gmail.com)
# Script created by Félix P Leiva, Radboud University (e-mail: felixpleiva@gmail.com)
# ------------------------------------------------------------------------------
# Cite as:
# Leiva FP, Boerrigter JGJ & Verberk WCEP. (2021). Draft version of paper data and
# code of manuscript: Phenotypic plasticity of body size and cell size to oxygen
# and temperature in Drosophila melanogaster. Zenodo.
# ------------------------------------------------------------------------------
# Cleaning working space
rm(list=ls())
today<-format(Sys.Date(),"%Y%m%d")
# ------------------------------------------------------------------------------
# set working directory
setwd("C:/Users/Invunche/Dropbox/GitHub/Plastic_responses_DGRP_lines/Data")
# check directory
getwd()
# ------------------------------------------------------------------------------
#Libraries
# library(dplyr)
library(xlsx)
# library(ggplot2)
# library(nlme)
# library(car)
# library(lmerTest)# P-values for mixed models
# library(visreg)# plotting regression models
# library(AICcmodavg)
# library(cowplot)
# ------------------------------------------------------------------------------
# load data
dat<-read.xlsx("body size related traits 20191122.xlsx",sheetName = "data")
head(dat)
# ------------------------------------------------------------------------------
# See data structure and transform if necessary
str(dat)
dat$generation<-as.factor(dat$generation)
dat$plate<-as.factor(dat$plate)
dat$well<-as.factor(dat$well)
dat$stock<-as.factor(dat$stock)
dat$sex<-as.factor(dat$sex)
dat$left_or_rigth<-as.factor(dat$left_or_rigth)
dat$temperature<-as.numeric(dat$temperature)
dat$oxygen<-as.numeric(dat$oxygen)
dat$left_or_rigth<-as.factor(dat$left_or_rigth)
#------------------------------------------------------------------------------
#create a new column to identify individual flies with the identical ID as for the
#wing photos
dat$ID_fly<-as.factor(paste(dat$plate,dat$well,sep = "-"))
#add  missing treatment from 25°C and 21 kPa
# Leiva FP, Santos M, Rezende E, & Verberk WCEP. (2021). Draft version of paper
# data and code of manuscript: Intraspecific variation on heat tolerance in a
# model ectotherm: effects of body mass, cell size, oxygen and sex (2.0).
# Zenodo. https://doi.org/10.5281/zenodo.5244364
#
new<-data.frame("28247","25","21","female","new_fly",
"1.465","1051254.1","162.5482","6457.345",
"0.1658376","6.021708","3.810054",
"2.210982")
names(new)<-c("stock","temperature","oxygen","sex","ID_fly",
"fresh_mass","wing_area","cell_area","cell_number",
"fresh_mass_log","wing_area_log","cell_number_log",
"cell_area_log")
# filter by sex
female=filter(dat,sex!="male")
male=filter(dat,sex=="male")
# ------------------------------------------------------------------------------
# subset of females by stock
f25180<-subset(dat,dat$stock=="25180" & dat$sex=="female")
f25182<-subset(dat,dat$stock=="25182" & dat$sex=="female")
f25203<-subset(dat,dat$stock=="25203" & dat$sex=="female")
f28141<-subset(dat,dat$stock=="28141" & dat$sex=="female")
f28196<-subset(dat,dat$stock=="28196" & dat$sex=="female")
f28247<-subset(dat,dat$stock=="28247" & dat$sex=="female")
# ------------------------------------------------------------------------------
# filter by sex
female=filter(dat,sex!="male")
# ------------------------------------------------------------------------------
# Data generated by Félix P Leiva, Radboud University (e-mail: felixpleiva@gmail.com)
# Script created by Félix P Leiva, Radboud University (e-mail: felixpleiva@gmail.com)
# ------------------------------------------------------------------------------
# Cite as:
# Leiva FP, Boerrigter JGJ & Verberk WCEP. (2021). Draft version of paper data and
# code of manuscript: Phenotypic plasticity of body size and cell size to oxygen
# and temperature in Drosophila melanogaster. Zenodo.
# ------------------------------------------------------------------------------
# Cleaning working space
rm(list=ls())
today<-format(Sys.Date(),"%Y%m%d")
# ------------------------------------------------------------------------------
# set working directory
setwd("C:/Users/Invunche/Dropbox/GitHub/Plastic_responses_DGRP_lines/Data")
# check directory
getwd()
# ------------------------------------------------------------------------------
#Libraries
# library(dplyr)
library(xlsx)
# library(ggplot2)
# library(nlme)
# library(car)
# library(lmerTest)# P-values for mixed models
# library(visreg)# plotting regression models
# library(AICcmodavg)
# library(cowplot)
# ------------------------------------------------------------------------------
# load data
dat<-read.xlsx("body size related traits 20191122.xlsx",sheetName = "data")
head(dat)
# ------------------------------------------------------------------------------
# See data structure and transform if necessary
str(dat)
dat$generation<-as.factor(dat$generation)
dat$plate<-as.factor(dat$plate)
dat$well<-as.factor(dat$well)
dat$stock<-as.factor(dat$stock)
dat$sex<-as.factor(dat$sex)
dat$left_or_rigth<-as.factor(dat$left_or_rigth)
dat$temperature<-as.numeric(dat$temperature)
dat$oxygen<-as.numeric(dat$oxygen)
dat$left_or_rigth<-as.factor(dat$left_or_rigth)
#------------------------------------------------------------------------------
#create a new column to identify individual flies with the identical ID as for the
#wing photos
dat$ID_fly<-as.factor(paste(dat$plate,dat$well,sep = "-"))
# ------------------------------------------------------------------------------
# filter by sex
female=filter(dat,sex!="male")
# ------------------------------------------------------------------------------
#Libraries
library(dplyr)
# ------------------------------------------------------------------------------
# filter by sex
female=filter(dat,sex!="male")
male=filter(dat,sex=="male")
# ------------------------------------------------------------------------------
# subset of females by stock
f25180<-subset(dat,dat$stock=="25180" & dat$sex=="female")
f25182<-subset(dat,dat$stock=="25182" & dat$sex=="female")
f25203<-subset(dat,dat$stock=="25203" & dat$sex=="female")
f28141<-subset(dat,dat$stock=="28141" & dat$sex=="female")
f28196<-subset(dat,dat$stock=="28196" & dat$sex=="female")
f28247<-subset(dat,dat$stock=="28247" & dat$sex=="female")
# Leiva FP, Santos M, Rezende E, & Verberk WCEP. (2021). Draft version of paper
# data and code of manuscript: Intraspecific variation on heat tolerance in a
# model ectotherm: effects of body mass, cell size, oxygen and sex (2.0).
# Zenodo. https://doi.org/10.5281/zenodo.5244364
#
new<-data.frame("28247","25","21","female","new_fly",
"1.465","1051254.1","162.5482","6457.345",
"0.1658376","6.021708","3.810054",
"2.210982")
names(new)<-c("stock","temperature","oxygen","sex","ID_fly",
"fresh_mass","wing_area","cell_area","cell_number",
"fresh_mass_log","wing_area_log","cell_number_log",
"cell_area_log")
#defining the data structure of the new data frame
new$stock<-as.factor(new$stock)
new$sex<-as.factor(new$sex)
new$ID_fly<-as.factor(new$ID_fly)
new$temperature<-as.numeric(new$temperature)
new$oxygen<-as.numeric(new$oxygen)
new$fresh_mass<-as.numeric(new$fresh_mass)
new$wing_area<-as.numeric(new$wing_area)
new$cell_area<-as.numeric(new$cell_area)
new$cell_number<-as.numeric(new$cell_number)
new$fresh_mass_log<-as.numeric(new$fresh_mass_log)
new$wing_area_log<-as.numeric(new$wing_area_log)
new$cell_area_log<-as.numeric(new$cell_area_log)
new$cell_number_log<-as.numeric(new$cell_number_log)
#merge two dataframes
f28247<-rbind(f28247,new)
# ------------------------------------------------------------------------------
# Data generated by Félix P Leiva, Radboud University (e-mail: felixpleiva@gmail.com)
# Script created by Félix P Leiva, Radboud University (e-mail: felixpleiva@gmail.com)
# ------------------------------------------------------------------------------
# Cite as:
# Leiva FP, Boerrigter JGJ & Verberk WCEP. (2021). Draft version of paper data and
# code of manuscript: Phenotypic plasticity of body size and cell size to oxygen
# and temperature in Drosophila melanogaster. Zenodo.
# ------------------------------------------------------------------------------
# Cleaning working space
rm(list=ls())
today<-format(Sys.Date(),"%Y%m%d")
# ------------------------------------------------------------------------------
# set working directory
setwd("C:/Users/Invunche/Dropbox/GitHub/Plastic_responses_DGRP_lines/Data")
# check directory
getwd()
# ------------------------------------------------------------------------------
#Libraries
library(dplyr)
library(xlsx)
# library(ggplot2)
# library(nlme)
# library(car)
# library(lmerTest)# P-values for mixed models
# library(visreg)# plotting regression models
# library(AICcmodavg)
# library(cowplot)
# ------------------------------------------------------------------------------
# load data
dat<-read.xlsx("body size related traits 20191122.xlsx",sheetName = "data")
head(dat)
# ------------------------------------------------------------------------------
# See data structure and transform if necessary
str(dat)
dat$generation<-as.factor(dat$generation)
dat$plate<-as.factor(dat$plate)
dat$well<-as.factor(dat$well)
dat$stock<-as.factor(dat$stock)
dat$sex<-as.factor(dat$sex)
dat$left_or_rigth<-as.factor(dat$left_or_rigth)
dat$temperature<-as.numeric(dat$temperature)
dat$oxygen<-as.numeric(dat$oxygen)
dat$left_or_rigth<-as.factor(dat$left_or_rigth)
# #------------------------------------------------------------------------------
# #create a new column to identify individual flies with the identical ID as for the
# #wing photos
# dat$ID_fly<-as.factor(paste(dat$plate,dat$well,sep = "-"))
# ------------------------------------------------------------------------------
# filter by sex
female=filter(dat,sex!="male")
male=filter(dat,sex=="male")
# ------------------------------------------------------------------------------
# subset of females by stock
f25180<-subset(dat,dat$stock=="25180" & dat$sex=="female")
f25182<-subset(dat,dat$stock=="25182" & dat$sex=="female")
f25203<-subset(dat,dat$stock=="25203" & dat$sex=="female")
f28141<-subset(dat,dat$stock=="28141" & dat$sex=="female")
f28196<-subset(dat,dat$stock=="28196" & dat$sex=="female")
f28247<-subset(dat,dat$stock=="28247" & dat$sex=="female")
# ------------------------------------------------------------------------------
# Data generated by Félix P Leiva, Radboud University (e-mail: felixpleiva@gmail.com)
# Script created by Félix P Leiva, Radboud University (e-mail: felixpleiva@gmail.com)
# ------------------------------------------------------------------------------
# Cite as:
# Leiva FP, Boerrigter JGJ & Verberk WCEP. (2021). Draft version of paper data and
# code of manuscript: Phenotypic plasticity of body size and cell size to oxygen
# and temperature in Drosophila melanogaster. Zenodo.
# ------------------------------------------------------------------------------
# Cleaning working space
rm(list=ls())
today<-format(Sys.Date(),"%Y%m%d")
# ------------------------------------------------------------------------------
# set working directory
setwd("C:/Users/Invunche/Dropbox/GitHub/Plastic_responses_DGRP_lines/Data")
# check directory
getwd()
# ------------------------------------------------------------------------------
#Libraries
library(dplyr)
library(xlsx)
# library(ggplot2)
# library(nlme)
# library(car)
# library(lmerTest)# P-values for mixed models
# library(visreg)# plotting regression models
# library(AICcmodavg)
# library(cowplot)
# ------------------------------------------------------------------------------
# load data
dat<-read.xlsx("body size related traits 20191122.xlsx",sheetName = "data")
head(dat)
# ------------------------------------------------------------------------------
# See data structure and transform if necessary
str(dat)
dat$generation<-as.factor(dat$generation)
dat$plate<-as.factor(dat$plate)
dat$well<-as.factor(dat$well)
dat$stock<-as.factor(dat$stock)
dat$sex<-as.factor(dat$sex)
dat$left_or_rigth<-as.factor(dat$left_or_rigth)
dat$temperature<-as.numeric(dat$temperature)
dat$oxygen<-as.numeric(dat$oxygen)
dat$left_or_rigth<-as.factor(dat$left_or_rigth)
# #------------------------------------------------------------------------------
# #create a new column to identify individual flies with the identical ID as for the
# #wing photos
# dat$ID_fly<-as.factor(paste(dat$plate,dat$well,sep = "-"))
# ------------------------------------------------------------------------------
# filter by sex
female=filter(dat,sex!="male")
male=filter(dat,sex=="male")
# ------------------------------------------------------------------------------
# subset of females by stock
f25180<-subset(dat,dat$stock=="25180" & dat$sex=="female")
f25182<-subset(dat,dat$stock=="25182" & dat$sex=="female")
f25203<-subset(dat,dat$stock=="25203" & dat$sex=="female")
f28141<-subset(dat,dat$stock=="28141" & dat$sex=="female")
f28196<-subset(dat,dat$stock=="28196" & dat$sex=="female")
f28247<-subset(dat,dat$stock=="28247" & dat$sex=="female")
#add  missing treatment (25°C and 21 kPa) from:
# Leiva FP, Santos M, Rezende E, & Verberk WCEP. (2021). Draft version of paper
# data and code of manuscript: Intraspecific variation on heat tolerance in a
# model ectotherm: effects of body mass, cell size, oxygen and sex (2.0).
# Zenodo. https://doi.org/10.5281/zenodo.5244364
new<-data.frame("28247","25","21","female","new_fly",
"1.465","1051254.1","162.5482","6457.345",
"0.1658376","6.021708","3.810054",
"2.210982")
names(new)<-c("stock","temperature","oxygen","sex","ID_fly",
"fresh_mass","wing_area","cell_area","cell_number",
"fresh_mass_log","wing_area_log","cell_number_log",
"cell_area_log")
#defining the data structure of the new data frame
new$stock<-as.factor(new$stock)
new$sex<-as.factor(new$sex)
new$ID_fly<-as.factor(new$ID_fly)
new$temperature<-as.numeric(new$temperature)
new$oxygen<-as.numeric(new$oxygen)
new$fresh_mass<-as.numeric(new$fresh_mass)
new$wing_area<-as.numeric(new$wing_area)
new$cell_area<-as.numeric(new$cell_area)
new$cell_number<-as.numeric(new$cell_number)
new$fresh_mass_log<-as.numeric(new$fresh_mass_log)
new$wing_area_log<-as.numeric(new$wing_area_log)
new$cell_area_log<-as.numeric(new$cell_area_log)
new$cell_number_log<-as.numeric(new$cell_number_log)
#merge two dataframes
f28247<-rbind(f28247,new)
# ------------------------------------------------------------------------------
# Data generated by Félix P Leiva, Radboud University (e-mail: felixpleiva@gmail.com)
# Script created by Félix P Leiva, Radboud University (e-mail: felixpleiva@gmail.com)
# ------------------------------------------------------------------------------
# Cite as:
# Leiva FP, Boerrigter JGJ & Verberk WCEP. (2021). Draft version of paper data and
# code of manuscript: Phenotypic plasticity of body size and cell size to oxygen
# and temperature in Drosophila melanogaster. Zenodo.
# ------------------------------------------------------------------------------
# Cleaning working space
rm(list=ls())
today<-format(Sys.Date(),"%Y%m%d")
# ------------------------------------------------------------------------------
# set working directory
setwd("C:/Users/Invunche/Dropbox/GitHub/Plastic_responses_DGRP_lines/Data")
# check directory
getwd()
# ------------------------------------------------------------------------------
#Libraries
library(dplyr)
library(xlsx)
# library(ggplot2)
# library(nlme)
# library(car)
# library(lmerTest)# P-values for mixed models
# library(visreg)# plotting regression models
# library(AICcmodavg)
# library(cowplot)
# ------------------------------------------------------------------------------
# load data
dat<-read.xlsx("body size related traits 20191122.xlsx",sheetName = "data")
head(dat)
# ------------------------------------------------------------------------------
# See data structure and transform if necessary
str(dat)
dat$generation<-as.factor(dat$generation)
dat$plate<-as.factor(dat$plate)
dat$well<-as.factor(dat$well)
dat$stock<-as.factor(dat$stock)
dat$sex<-as.factor(dat$sex)
dat$left_or_rigth<-as.factor(dat$left_or_rigth)
dat$temperature<-as.numeric(dat$temperature)
dat$oxygen<-as.numeric(dat$oxygen)
dat$left_or_rigth<-as.factor(dat$left_or_rigth)
# #------------------------------------------------------------------------------
# #create a new column to identify individual flies with the identical ID as for the
# #wing photos
# dat$ID_fly<-as.factor(paste(dat$plate,dat$well,sep = "-"))
# ------------------------------------------------------------------------------
# filter by sex
female=filter(dat,sex!="male")
male=filter(dat,sex=="male")
# ------------------------------------------------------------------------------
# subset of females by stock
f25180<-subset(dat,dat$stock=="25180" & dat$sex=="female")
f25182<-subset(dat,dat$stock=="25182" & dat$sex=="female")
f25203<-subset(dat,dat$stock=="25203" & dat$sex=="female")
f28141<-subset(dat,dat$stock=="28141" & dat$sex=="female")
f28196<-subset(dat,dat$stock=="28196" & dat$sex=="female")
f28247<-subset(dat,dat$stock=="28247" & dat$sex=="female")
xtabs(formula = ~sex + stock)
xtabs(formula = ~sex + stock,data=dat)
xtabs(formula = ~sex + stock+ temperature+oxygen,data=dat)
View(f28141)
# ------------------------------------------------------------------------------
# Data generated by Félix P Leiva, Radboud University (e-mail: felixpleiva@gmail.com)
# Script created by Félix P Leiva, Radboud University (e-mail: felixpleiva@gmail.com)
# ------------------------------------------------------------------------------
# Cite as:
# Leiva FP, Boerrigter JGJ & Verberk WCEP. (2021). Draft version of paper data and
# code of manuscript: Phenotypic plasticity of body size and cell size to oxygen
# and temperature in Drosophila melanogaster. Zenodo.
# ------------------------------------------------------------------------------
# Cleaning working space
rm(list=ls())
today<-format(Sys.Date(),"%Y%m%d")
# ------------------------------------------------------------------------------
# set working directory
setwd("C:/Users/Invunche/Dropbox/GitHub/Plastic_responses_DGRP_lines/Data")
# check directory
getwd()
# ------------------------------------------------------------------------------
#Libraries
library(dplyr)
library(xlsx)
# library(ggplot2)
# library(nlme)
# library(car)
# library(lmerTest)# P-values for mixed models
# library(visreg)# plotting regression models
# library(AICcmodavg)
# library(cowplot)
# ------------------------------------------------------------------------------
# load data
dat<-read.xlsx("body size related traits 20191122.xlsx",sheetName = "data")
head(dat)
# ------------------------------------------------------------------------------
# See data structure and transform if necessary
str(dat)
dat$generation<-as.factor(dat$generation)
dat$plate<-as.factor(dat$plate)
dat$well<-as.factor(dat$well)
dat$stock<-as.factor(dat$stock)
dat$sex<-as.factor(dat$sex)
dat$left_or_rigth<-as.factor(dat$left_or_rigth)
dat$temperature<-as.numeric(dat$temperature)
dat$oxygen<-as.numeric(dat$oxygen)
dat$left_or_rigth<-as.factor(dat$left_or_rigth)
# ------------------------------------------------------------------------------
# Data generated by Félix P Leiva, Radboud University (e-mail: felixpleiva@gmail.com)
# Script created by Félix P Leiva, Radboud University (e-mail: felixpleiva@gmail.com)
# ------------------------------------------------------------------------------
# Cite as:
# Leiva FP, Boerrigter JGJ & Verberk WCEP. (2021). Draft version of paper data and
# code of manuscript: Phenotypic plasticity of body size and cell size to oxygen
# and temperature in Drosophila melanogaster. Zenodo.
# ------------------------------------------------------------------------------
# Cleaning working space
rm(list=ls())
today<-format(Sys.Date(),"%Y%m%d")
# ------------------------------------------------------------------------------
# set working directory
setwd("C:/Users/Invunche/Dropbox/GitHub/Plastic_responses_DGRP_lines/Data")
# check directory
getwd()
# ------------------------------------------------------------------------------
#Libraries
library(dplyr)
library(xlsx)
# library(ggplot2)
# library(nlme)
# library(car)
# library(lmerTest)# P-values for mixed models
# library(visreg)# plotting regression models
# library(AICcmodavg)
# library(cowplot)
# ------------------------------------------------------------------------------
# load data
dat<-read.xlsx("body size related traits 20191122.xlsx",sheetName = "data")
head(dat)
# ------------------------------------------------------------------------------
# See data structure and transform if necessary
str(dat)
dat$generation<-as.factor(dat$generation)
dat$plate<-as.factor(dat$plate)
dat$well<-as.factor(dat$well)
dat$stock<-as.factor(dat$stock)
dat$sex<-as.factor(dat$sex)
dat$left_or_rigth<-as.factor(dat$left_or_rigth)
dat$temperature<-as.numeric(dat$temperature)
dat$oxygen<-as.numeric(dat$oxygen)
dat$left_or_rigth<-as.factor(dat$left_or_rigth)
# ------------------------------------------------------------------------------
# filter by sex
female=filter(dat,sex!="male")
male=filter(dat,sex=="male")
# ------------------------------------------------------------------------------
# subset of females by stock
f25180<-subset(dat,dat$stock=="25180" & dat$sex=="female")
f25182<-subset(dat,dat$stock=="25182" & dat$sex=="female")
f25203<-subset(dat,dat$stock=="25203" & dat$sex=="female")
f28141<-subset(dat,dat$stock=="28141" & dat$sex=="female")
f28196<-subset(dat,dat$stock=="28196" & dat$sex=="female")
f28247<-subset(dat,dat$stock=="28247" & dat$sex=="female")
# count number of observations per treatment combination, stock and sex
xtabs(formula = ~sex + stock+ temperature+oxygen,data=f25180)
# count number of observations per treatment combination, stock and sex
xtabs(formula = ~sex + temperature + oxygen,data=f25180)
# count number of observations per treatment combination, stock and sex
xtabs(formula = ~sex,data=f25180)
# count number of observations per treatment combination, stock and sex
xtabs(formula = ~temperature,data=f25180)
# count number of observations per treatment combination, stock and sex
xtabs(formula = ~temperature+oxygen,data=f25180)
# count number of observations per treatment combination, stock and sex
xtabs(formula = ~temperature + oxygen, data = f25180)
# count number of observations per treatment
xtabs(formula = ~temperature + oxygen, data = f25180)
xtabs(formula = ~temperature + oxygen, data = f25182)
